webpackJsonp([1],{"+2Sf":function(e,t){},"+2XG":function(e,t){},"+cFj":function(e,t){},"+lKd":function(e,t){},"/cd1":function(e,t){},"0o30":function(e,t,s){"use strict";var a=s("zL8q");s.n(a);t.a={errorMessage:function(e){Object(a.Message)({message:e,type:"error",showClose:!0})},successMessage:function(e){Object(a.Message)({message:e,type:"success",showClose:!0})},promptMessage:function(e){Object(a.Message)({message:e,type:"prompt",showClose:!0})}}},"0zUu":function(e,t){},"13F4":function(e,t){},"1FOl":function(e,t){},"3KO8":function(e,t){},"3Uzm":function(e,t){},"5iXh":function(e,t){},"6xlM":function(e,t){},"70a4":function(e,t){},"7IGw":function(e,t){},"9mg6":function(e,t){},AAG4:function(e,t){},AFc0:function(e,t,s){"use strict";var a={name:"elmenuitem",props:{menu:{type:Object}},data:function(){return{}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return"item"==e.menu.type?s("el-menu-item",{attrs:{index:e.menu.index,route:e.menu.route}},[s("i",{class:e.menu.icon}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.menu.lable))])]):e._e()},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(e){s("7IGw")},"data-v-1dad1169",null);t.a=n.exports},AU0r:function(e,t){},BNnv:function(e,t){},DXMo:function(e,t){},Dtpj:function(e,t){},EZ5W:function(e,t){},F3Yw:function(e,t){},FUlO:function(e,t){},GN1v:function(e,t){},HBay:function(e,t){},Hh1Y:function(e,t){},INe6:function(e,t){},IRBr:function(e,t){},IcnI:function(e,t,s){"use strict";var a=s("7+uW"),i=s("NYxO"),n=s("Gu7T"),r=s.n(n),o=s("mtWM"),l=s.n(o),c={namespaced:!0,state:{movie_list:"",on_movie:"",coming_movie:"",hot_movie:"",down_movie:"",on_movie_list:"",coming_movie_list:""},getters:{getHotMovieList:function(e){return e.hot_movie=[].concat(r()(e.movie_list)),e.hot_movie.sort(function(e,t){return t.movieNumWantSee-e.movieNumWantSee}),e.hot_movie.slice(0,10)},getDownloadMovieList:function(e){return e.down_movie=[].concat(r()(e.movie_list)),e.down_movie.sort(function(e,t){return t.movieDownload-e.movieDownload}),e.down_movie.slice(0,10)}},actions:{getData:function(e){var t=e.commit;l.a.get("api/showRanking").then(function(e){t("setMovieList",e.data.data),t("getOnMovieList",{page:1,page_size:5}),t("getComingMovieList",{page:1,page_size:5})})}},mutations:{setMovieList:function(e,t){var s=(new Date).getTime();e.movie_list=t,e.on_movie=t.filter(function(e){return e.movieShowTime<s}),e.coming_movie=t.filter(function(e){return e.movieShowTime>=s})},getOnMovieList:function(e,t){var s=(t.page-1)*t.page_size,a=t.page_size*t.page;e.on_movie_list=e.on_movie.slice(s,a)},getComingMovieList:function(e,t){var s=(t.page-1)*t.page_size,a=t.page_size*t.page;e.coming_movie_list=e.coming_movie.slice(s,a)}}},u=s("lHA8"),m=s.n(u),d={namespaced:!0,state:{article:[],article_list:[],article_detail:"",article_user:[],article_user_list:[],article_hot:[],article_hot_list:[],article_topic:[]},getters:{},actions:{getData:function(e){var t=e.commit;l.a.get("api/showArticle").then(function(e){t("setArticleList",e.data.data),t("getArticleList",{page:1,page_size:10})})}},mutations:{setArticleList:function(e,t){e.article=t},getArticleList:function(e,t){var s=(t.page-1)*t.page_size,a=t.page_size*t.page;e.article_list=e.article.slice(s,a)},getArticle:function(e,t){e.article_detail=e.article.filter(function(e){return e._id==t.article_id})},getUserArticle:function(e,t){e.article_user=e.article.filter(function(e){return e.articleUserId==t.articleUserId})},setUserArticleList:function(e,t){var s=(t.page-1)*t.page_size,a=t.page*t.page_size;e.article_user_list=e.article_user.slice(s,a)},setHotArticle:function(e,t){var s=[].concat(r()(e.article));s.sort(function(e,t){return t.articleNumSuppose-e.articleNumSuppose}),e.article_hot=s.slice(0,10)},setHotArticleList:function(e,t){var s=(t.page-1)*t.page_size,a=t.page*t.page_size;e.article_hot_list=e.article_hot.slice(s,a)},setTopic:function(e){e.article_topic=new m.a,e.article.map(function(t){return e.article_topic.add(t.articleTopic)})}}};a.default.use(i.a);var f=new i.a.Store({modules:{movie:c,article:d},actions:{},state:{},mutations:{}});t.a=f},Ik35:function(e,t){},Ixbm:function(e,t){},KYD1:function(e,t){},Kg5V:function(e,t){},Kolr:function(e,t){},"L/yC":function(e,t){},LDYG:function(e,t){},LrLx:function(e,t){},M93x:function(e,t,s){"use strict";var a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=s("VU/8")({name:"App",created:function(){}},a,!1,function(e){s("L/yC")},null,null);t.a=i.exports},Mmi6:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=s("fZjL"),a=s.n(t),i=s("//Fk"),n=s.n(i),r=s("Dd8w"),o=s.n(r),l=s("7+uW"),c=s("M93x"),u=s("YaEn"),m=s("mtWM"),d=s.n(m),f=s("mw3O"),p=s.n(f),v=s("IcnI"),h=s("zL8q"),g=s.n(h),_=s("tvR6"),b=(s.n(_),s("fdud")),x=s("0o30");e.qs=s("mw3O"),d.a.defaults.timeout=6e3,d.a.interceptors.request.use(function(e){return e.headers["Content-Type"]="application/x-www-form-urlencoded","post"===e.method&&(e.data=p.a.stringify(o()({},e.data))),e},function(e){return loadinginstace.close(),n.a.reject(e)}),d.a.interceptors.response.use(function(e){return e},function(e){return n.a.reject(e)}),a()(b).forEach(function(e){l.default.filter(e,b[e])}),l.default.prototype.axios=d.a,l.default.prototype.mes=x.a,l.default.use(g.a),l.default.config.productionTip=!1,new l.default({el:"#app",router:u.a,store:v.a,components:{App:c.a},template:"<App/>"})}.call(t,s("DuR2"))},NxzW:function(e,t){},"P+6U":function(e,t){},P46r:function(e,t){},PgMh:function(e,t){},Qki6:function(e,t){},RfpI:function(e,t){},Sobn:function(e,t){},WcrD:function(e,t){},XUyS:function(e,t){},XuWr:function(e,t){},YaEn:function(e,t,s){"use strict";var a=s("Gu7T"),i=s.n(a),n=s("7+uW"),r=s("/ocq"),o=s("Dd8w"),l=s.n(o),c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"main"},[t("div",{staticClass:"left"},[t("router-link",{attrs:{to:"/"}},[t("div",{staticClass:"header_menu"},[this._v("主页")])]),this._v(" "),t("router-link",{attrs:{to:"/movieList"}},[t("div",{staticClass:"header_menu"},[this._v("电影")])])],1),this._v(" "),t("div",{staticClass:"right"},[t("router-link",{attrs:{to:{path:"/adminPage"}}},[t("div",{staticClass:"header_menu"},[this._v("\n\t\t\t\t\t后台\n\t\t\t\t")])])],1)])])},staticRenderFns:[]};var u=s("VU/8")({},c,!1,function(e){s("IRBr")},"data-v-33e6c27b",null).exports,m={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"footer"},[t("p",[this._v("底部实例")])])}]};var d=s("VU/8")({},m,!1,function(e){s("Dtpj")},"data-v-89113bb8",null).exports,f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._l(e.list,function(t,a){return s("li",{key:a,staticClass:"newslist"},[s("div",{staticClass:"newsList"},[s("router-link",{staticClass:"goods-list-link",attrs:{to:{path:"/newDetail/"+t._id}}},[e._v("\n\t\t\t\t"+e._s(t.articleTitle)+"\n\t\t\t")])],1)])}),0)},staticRenderFns:[]};var p=s("VU/8")({name:"newsList",data:function(){return{}},props:["list"],created:function(){},methods:{}},f,!1,function(e){s("+2Sf")},"data-v-35f433d0",null).exports,v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"movieList"},[s("el-popover",{attrs:{placement:"right",trigger:"hover",offset:"20",width:"180"}},[s("div",{staticClass:"hidden",staticStyle:{padding:"28px 0px"}},[s("h3",[e._v(e._s(e.list.movieName)+" ")]),e._v(" "),s("p",{staticStyle:{margin:"15px 0px"}},[e._v("***"+e._s(e.list.movieMark)+"***("+e._s(e.list.movieNumDownload)+"人想看)")]),e._v(" "),s("P",{staticStyle:{"margin-bottom":"15px"}},[s("span",[e._v(e._s(e.list.movieDuration)+"分钟   ")]),s("span",[e._v(e._s(e.list.movieCountry))])]),e._v(" "),s("p",{staticStyle:{"margin-bottom":"15px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[e._v("导演: "),s("span",[e._v(e._s(e.list.movieDirector))])]),e._v(" "),s("p",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[e._v("演员: "),s("span",[e._v(e._s(e.list.movieActor))])])],1),e._v(" "),s("div",{attrs:{slot:"reference"},slot:"reference"},[s("router-link",{attrs:{to:{path:"/movieDetail/"+e.list._id}}},[s("img",{attrs:{src:e.list.movieImg}}),e._v(" "),s("h3",[e._v(e._s(e.list.movieName))])]),e._v(" "),s("p",[s("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900"},model:{value:e.list.movieMark,callback:function(t){e.$set(e.list,"movieMark",t)},expression:"list.movieMark"}})],1),e._v(" "),s("button",{on:{click:e.btnBuy}},[e._v("选座购票")])],1)])],1)])},staticRenderFns:[]};var h=s("VU/8")({data:function(){return{}},props:["list"],created:function(){},methods:{btnBuy:function(){this.$router.push({path:"/movieBuy"})}}},v,!1,function(e){s("wVAH"),s("Yjyw")},"data-v-019b7794",null).exports,g={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"img"},[t("el-carousel",{attrs:{height:"300px","indicator-position":"outside",type:"card"}},this._l(this.list,function(e,s){return t("el-carousel-item",{key:s},[t("img",{attrs:{src:e.recommendImg}})])}),1)],1)},staticRenderFns:[]};var _=s("VU/8")({data:function(){return{}},props:["list"],created:function(){}},g,!1,function(e){s("c9ag")},"data-v-ec39ff62",null).exports,b={data:function(){return{isLogin:!1,username:"",user_id:""}},created:function(){localStorage.getItem("token")&&(this.isLogin=!0,this.username=localStorage.getItem("username"),this.user_id=localStorage.getItem("_id"))},methods:{handleCommand:function(e){"userInfo"==e&&this.$router.push({path:"/userInfo/"+this.user_id}),"userAccount"==e&&this.$router.push({path:"/userAccount/"+this.user_id}),"cancelLogin"==e&&(localStorage.removeItem("username"),localStorage.removeItem("token"),localStorage.removeItem("_id"),this.isLogin=!1),"sendEmail"==e&&this.$router.push({path:"/sendEmail"}),"repassword"==e&&this.$router.push({path:"/repassword"})}}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header"},[s("div",{staticClass:"main"},[s("div",{staticClass:"content"},[e.isLogin?s("div",[s("el-dropdown",{on:{command:e.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[e._v("\n\t\t\t\t\t\t"+e._s(e.username)+"的个人账号\n\t\t\t\t\t\t"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"userInfo"}},[e._v("个人主页")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"userAccount"}},[e._v("账号管理")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"sendEmail"}},[e._v("站内信")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"repassword"}},[e._v("修改密码")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"cancelLogin"}},[e._v("退出")])],1)],1)],1):s("div",[s("router-link",{attrs:{to:"/loginPage"}},[s("div",{staticClass:"header_menu"},[e._v("登陆")])])],1)])])])},staticRenderFns:[]};var w=s("VU/8")(b,x,!1,function(e){s("dHp5")},"data-v-15f206aa",null).exports,C={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},e._l(e.list,function(t,a){return s("div",{key:a,staticClass:"notice"},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.btn(t.context)}}},[e._v(e._s(t.title))]),e._v(" "),s("span",[e._v(" 发布于:"+e._s(e._f("forMatTime")(t.time)))])])}),0)},staticRenderFns:[]};var k=s("VU/8")({name:"notice",data:function(){return{list:""}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.get("api/showNotice").then(function(t){e.list=t.data.data})},btn:function(e){this.$alert(e,"网站公告",{confirmButtonText:"确定"})}}},C,!1,function(e){s("rbq/")},"data-v-409d98fb",null).exports,y=s("NYxO"),M={name:"index",data:function(){return{indexPic:[]}},components:{MovieIndexHeader:u,CommonFooter:d,NewsList:p,MovieList:h,IndexHeaderPic:_,UserMessage:w,notice:k},created:function(){this.getData()},methods:{getData:function(){var e=this;this.$store.dispatch("movie/getData"),this.$store.dispatch("article/getData"),this.axios.get("api/showIndex").then(function(t){e.indexPic=t.data.data})},onChange:function(e){this.$store.commit("movie/getOnMovieList",{page:e,page_size:5})},comingChange:function(e){this.$store.commit("movie/getComingMovieList",{page:e,page_size:5})},articleChange:function(e){this.$store.commit("article/getArticleList",{page:e,page_size:5})}},computed:l()({},Object(y.c)("movie",{getOnMovieList:function(e){return e.on_movie_list},getOnPage:function(e){return e.on_movie.length},getComingPage:function(e){return e.coming_movie.length},getComingMovieList:function(e){return e.coming_movie_list}}),Object(y.c)("article",{getArticleList:function(e){return e.article_list},getArticlePage:function(e){return e.article.length}}))},S={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"container"},[s("div",[s("movie-index-header")],1),e._v(" "),s("div",{staticClass:"userMessage"},[s("user-message")],1),e._v(" "),s("div",{staticClass:"contentPic"},[s("index-header-pic",{attrs:{list:e.indexPic}})],1),e._v(" "),s("div",{staticClass:"contentMain"},[s("el-row",{attrs:{gutter:60}},[s("el-col",{attrs:{span:14}},[s("div",{staticClass:"show"},[s("div",{staticClass:"pagination"},[s("h2",[e._v("正在上映")]),e._v(" "),s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:Number(e.getOnPage),"page-size":5},on:{"current-change":e.onChange}})],1),e._v(" "),s("div",{staticClass:"onshow"},e._l(e.getOnMovieList,function(e,t){return s("div",{key:t},[s("movie-list",{attrs:{list:e}})],1)}),0)]),e._v(" "),s("div",{staticClass:"show"},[s("div",{staticClass:"pagination"},[s("h2",[e._v("将要上映")]),e._v(" "),s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:Number(e.getComingPage),"page-size":5},on:{"current-change":e.comingChange}})],1),e._v(" "),s("div",{staticClass:"onshow"},e._l(e.getComingMovieList,function(e,t){return s("div",{key:t},[s("movie-list",{attrs:{list:e}})],1)}),0)])]),e._v(" "),s("el-col",{staticClass:"news",attrs:{span:10}},[s("div",{staticClass:"pagination"},[s("h2",[e._v("文章区域")]),e._v(" "),s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:Number(e.getArticlePage),"page-size":10},on:{"current-change":e.articleChange}})],1),e._v(" "),s("news-list",{attrs:{list:e.getArticleList}}),e._v(" "),s("h2",[e._v("网站公告")]),e._v(" "),s("notice")],1)],1)],1)]),e._v(" "),s("div",[s("common-footer")],1)])},staticRenderFns:[]};var D=s("VU/8")(M,S,!1,function(e){s("P+6U")},"data-v-389e6146",null).exports,$=s("hNev"),U=s("pPz8"),I=s("AFc0"),L={name:"siderwrapper",data:function(){return{user:"",leftMenus:[]}},props:["isCollapse"],created:function(){this.getData(),this.mockData()},methods:{getData:function(){var e=this;this.axios.post("api/users/userDetail",{user_id:localStorage._id}).then(function(t){e.user=t.data.data[0],e.user.userAdmin||(e.mes.promptMessage("您不是管理员，不能登录后台"),e.$router.go(-1)),e.user.userStop&&(e.mes.promptMessage("您的账号被禁停，请联系管理员"),e.$router.go(-1))})},handleSelect:function(e,t,s){s.route&&"inner"===s.route.type&&this.$router.push(s.route.path)},mockData:function(){this.leftMenus.push({type:"submenu",index:"/adminPage/user",lable:"用户",icon:"el-icon-user",route:{type:"inner",path:"/adminPage/user"},childs:[{type:"item",index:"/adminPage/user/userAll",lable:"所有用户",icon:"el-icon-s-check",route:{type:"inner",path:"/adminPage/user/userAll"}},{type:"submenu",index:"/adminPage/user/userManage",lable:"用户管理",icon:"el-icon-edit",route:{type:"inner",path:"/adminPage/user/userManage"},childs:[{type:"item",index:"/adminPage/user/userManage/userAdd",lable:"添加用户",icon:"el-icon-circle-plus",route:{type:"inner",path:"/adminPage/user/userManage/userAdd"}},{type:"item",index:"/adminPage/user/userManage/userRev",lable:"编辑用户",icon:"el-icon-remove",route:{type:"inner",path:"/adminPage/user/userManage/userRev"}}]}]}),this.leftMenus.push({type:"submenu",index:"3",lable:"网站建设",icon:"el-icon-setting",childs:[{type:"submenu",index:"3-1",lable:"网站首页",icon:"el-icon-s-data",childs:[{type:"item",index:"/adminPage/websiteBuilt/websiteIndex/planting",lable:"轮播图",icon:"el-icon-loading",route:{type:"inner",path:"/adminPage/websiteBuilt/websiteIndex/planting"}},{type:"item",index:"/adminPage/websiteBuilt/websiteIndex/websiteNotice",lable:"网站公告",icon:"el-icon-tickets",route:{type:"inner",path:"/adminPage/websiteBuilt/websiteIndex/websiteNotice"}}]},{type:"submenu",index:"3-2",lable:"电影",icon:"el-icon-monitor",childs:[{type:"item",index:"/adminPage/websiteBuilt/movie/movieDetail",lable:"电影详情",icon:"el-icon-more-outline",route:{type:"inner",path:"/adminPage/websiteBuilt/movie/movieDetail"}},{type:"item",index:"/adminPage/websiteBuilt/movie/movieAdd",lable:"添加电影",icon:"el-icon-circle-plus",route:{type:"inner",path:"/adminPage/websiteBuilt/movie/movieAdd"}},{type:"item",index:"/adminPage/websiteBuilt/movie/movieActivity",lable:"电影活动",icon:"el-icon-message",route:{type:"inner",path:"/adminPage/websiteBuilt/movie/movieActivity"}}]},{type:"submenu",index:"3-3",lable:"文章",icon:"el-icon-document-copy",childs:[{type:"item",index:"/adminPage/websiteBuilt/article/articleDetail",lable:"文章详情",icon:"el-icon-more-outline",route:{type:"inner",path:"/adminPage/websiteBuilt/article/articleDetail"}},{type:"item",index:"/adminPage/websiteBuilt/article/articleAdd",lable:"添加文章",icon:"el-icon-circle-plus",route:{type:"inner",path:"/adminPage/websiteBuilt/article/articleAdd"}}]}]}),this.leftMenus.push({type:"submenu",index:"4",lable:"站内通信",icon:"el-icon-message",childs:[{type:"item",index:"/adminPage/communication/email",lable:"站内信",icon:"el-icon-message",route:{type:"inner",path:"/adminPage/communication/email"}},{type:"item",index:"/adminPage/communication/userInfoComment",lable:"主页留言",icon:"el-icon-chat-line-round",route:{type:"inner",path:"/adminPage/communication/userInfoComment"}},{type:"item",index:"/adminPage/communication/movieComment",lable:"电影评论",icon:"el-icon-chat-round",route:{type:"inner",path:"/adminPage/communication/movieComment"}},{type:"item",index:"/adminPage/communication/articleComment",lable:"文章评论",icon:"el-icon-chat-dot-square",route:{type:"inner",path:"/adminPage/communication/articleComment"}}]})}},components:{ElSubmenuEx:U.default,ElMenuItemEx:I.a,ElMenuItemGroupEx:$.a}},T={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-menu",{staticClass:"sider-wrapper",attrs:{"unique-opened":!0,"background-color":"#2f4050","text-color":"#fff","active-text-color":"#ffd04b",collapse:e.isCollapse,"default-active":e.$route.path},on:{select:e.handleSelect}},[s("div",{staticClass:"profile"},[e.isCollapse?e._e():s("img",{attrs:{src:e.user.userImg}}),e._v(" "),e.isCollapse?e._e():s("h3",[e._v(e._s(e.user.username))])]),e._v(" "),e._l(e.leftMenus,function(t){return[s("el-menu-item-group-ex",{attrs:{menu:t}}),e._v(" "),s("el-menu-item-ex",{attrs:{menu:t}}),e._v(" "),s("el-submenu-ex",{attrs:{menu:t}})]})],2)},staticRenderFns:[]};var E={name:"navbar",data:function(){return{levelList:null}},created:function(){},mounted:function(){this.getBread()},watch:{$route:function(e,t){this.getBread()}},methods:{onDrop:function(){this.$emit("listenOnDrop")},getBread:function(){var e=this.$route.matched.filter(function(e){return e.name}),t=e[0];t&&"adminPage"!==t.name&&(e=[{path:"/adminPage",mata:{title:"首页"}}].concat(e)),this.levelList=e},handleCommand:function(e){"userInfo"==e&&this.$router.push({path:"/userInfo/"+localStorage._id}),"userAccount"==e&&this.$router.push({path:"/userAccount/"+localStorage._id}),"sendEmail"==e&&this.$router.push({path:"/sendEmail"}),"repassword"==e&&this.$router.push({path:"/repassword"})},cancelLogin:function(){this.$router.push({path:"/"})}}},A={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"nav-left"},[s("i",{staticClass:"el-icon-menu",on:{click:e.onDrop}})]),e._v(" "),s("div",{staticClass:"nav-bread"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},e._l(e.levelList,function(t){return t.meta.title?s("el-breadcrumb-item",{key:t.path},[s("router-link",{attrs:{to:{path:t.path}}},[e._v(e._s(t.meta.title))])],1):e._e()}),1)],1),e._v(" "),s("div",{staticClass:"nav-right"},[s("el-dropdown",{on:{command:e.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[s("i",{staticClass:"el-icon-user-solid"}),e._v("\n\t\t\t\t个人中心\n\t\t\t")]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"userInfo"}},[e._v("个人主页")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"userAccount"}},[e._v("账号管理")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"sendEmail"}},[e._v("站内信")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"repassword"}},[e._v("修改密码")])],1)],1),e._v(" "),s("span",{on:{click:e.cancelLogin}},[s("i",{staticClass:"el-icon-s-unfold"}),e._v("退出")])],1)])},staticRenderFns:[]};var z={name:"admin",data:function(){return{isCollapse:!1}},created:function(){localStorage.token||(this.mes.promptMessage("请先登录才能进入后台"),this.$router.push({path:"/loginPage"}))},methods:{onDrop:function(){this.isCollapse?this.isCollapse=!1:this.isCollapse=!0}},components:{SiderWrapper:s("VU/8")(L,T,!1,function(e){s("FUlO")},"data-v-549b9f5a",null).exports,NavBar:s("VU/8")(E,A,!1,function(e){s("muti")},"data-v-6c524562",null).exports}},P={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"admin"},[t("sider-wrapper",{attrs:{isCollapse:this.isCollapse}}),this._v(" "),t("div",{staticClass:"main-wrapper"},[t("div",{staticClass:"navbar"},[t("nav-bar",{on:{listenOnDrop:this.onDrop}})],1),this._v(" "),t("router-view",{staticClass:"main"})],1)],1)},staticRenderFns:[]};var B=s("VU/8")(z,P,!1,function(e){s("qlS9")},"data-v-f2b5f368",null).exports,F={name:"index",data:function(){return{user:""}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.post("api/users/userDetail",{user_id:localStorage._id}).then(function(t){0==t.data.status?e.user=t.data.data[0]:e.mes.errorMessage(t.data.message)})}}},R={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("div",{staticClass:"user"},[s("div",{staticClass:"userImg"},[s("img",{attrs:{src:e.user.userImg}})]),e._v(" "),s("div",{staticClass:"userInfo"},[s("p",[s("span",[e._v("姓名:")]),e._v(e._s(e.user.username))]),e._v(" "),s("p",[s("span",[e._v("邮箱:")]),e._v(e._s(e.user.userMail))]),e._v(" "),s("p",[s("span",[e._v("电话:")]),e._v(e._s(e.user.userPhone))]),e._v(" "),s("p",[s("span",[e._v("个人描述:")]),e._v(e._s(e.user.userDescription))])])]),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"website"},[s("h3",[e._v("网站说明:")]),e._v(" "),s("ul",[s("li",[e._v("\n\t              1.这个网站的前台架构搭建基于vue-cli，页面基于vue，数据交互基于axios，路由管理基于router，也使用到了vuex，页面布局使用element-ui；关于后台，架构搭建基于express，文件的存储使用multer，数据库使用的是mongoDB；数据库存储数据，当加载页面时，前台通过调用api获取数据库数据对前台进行渲染；当用户操作时，前台通过调用api对数据库数据进行修改\n            ")]),e._v(" "),s("li",[e._v("\n                  2.这个网站的前台实现了电影页面、文章页面、个人主页、站内信等页面的展示；实现了用户的注册、登录、修改密码，用户可以在前台对电影进行评分、点赞、评论，对文章进行评论、评分、点赞，对用户进行主页浏览、主页留言、添加关注、加入黑名单等，浏览站内信、删除站内信、发送站内信、移除黑名单、移除关注列表等；后台实现了管理员的登录、对用户状态的管理、用户的添加、用户的编辑、用户的删除等功能，实现了对站内通信的一个管理、对站内信的一个删除、对文章评论、电影评论、个人主页评论的审核和删除，实现了对网站首页轮播图、网站首页公告一个删除、编辑、添加，实现了对后台文章的一个删除、添加、编辑，实现了对电影信息的添加、删除、编辑；当然这些编辑的信息并不会修改用户点赞等信息；\n            ")]),e._v(" "),s("li",[e._v("   \t\n                  3.这个网站还有许多的需要改进的地方，如购票方面没有设计，如各种电影，文章类型分的不彻底等，数据库数据为个人添加，所以数据量较少且不全面，还有其他的一些细节，性能的优化，慢慢会完善；\n            ")]),e._v(" "),s("li",[e._v("\n                  4.如果此开源项目对你有所帮助的话，请到给个star，也算给新人的一个鼓励，未来一起加油吧……  \n            ")])])])}]};var V=s("VU/8")(F,R,!1,function(e){s("tthb")},"data-v-96b4cf34",null).exports,O={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-view")],1)},staticRenderFns:[]};var N=s("VU/8")({name:"user",data:function(){return{}},created:function(){},methods:{}},O,!1,function(e){s("t0uw")},"data-v-7a074c29",null).exports,j={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n\tuserIndex\n")])},staticRenderFns:[]};var H=s("VU/8")({name:"userIndex",data:function(){return{}},created:function(){},methods:{}},j,!1,function(e){s("vobF")},"data-v-c6661cca",null).exports,W={name:"userAll",data:function(){return{multipleSelection:[],user:[],search:"",pagesize:10,userList:[]}},created:function(){this.getData()},filters:{formatAdmin:function(e){return e?"是":"否"},formatStop:function(e){return e?"封停":"正常"}},methods:{sortByDate:function(e,t){return e.userJoinTime-t.userJoinTime},filterAdmin:function(e,t){return t.userAdmin===e},filterStop:function(e,t){return t.userStop===e},handleCurrentChange:function(e){this.getuserList(e,this.pagesize)},getData:function(){var e=this,t=localStorage.username,s=localStorage.token,a=localStorage._id;this.axios.post("api/admin/showUser",{username:t,token:s,id:a}).then(function(t){e.user=t.data.data,e.getuserList(1,e.pagesize)})},getuserList:function(e,t){this.userList=this.user.slice((e-1)*t,e*t)}}},J={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("router-link",{attrs:{to:{path:"/adminPage/user/userManage/userAdd"}}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 添加用户")])],1),s("router-link",{attrs:{to:{path:"/adminPage/user/userManage/userRev"}}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 编辑用户")])],1),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入姓名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userList.filter(function(t){return!e.search||t.username.toLowerCase().includes(e.search.toLowerCase())}),border:""}},[s("el-table-column",{attrs:{type:"index",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userImg",label:"头像",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.userImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用户名",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{size:"medium"}},[e._v("\n\t\t\t\t    \t\t\t"+e._s(t.row.username)+"\n\t\t\t\t    \t\t")])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"userMail",label:"邮箱",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userCity",label:"地址",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{label:"注册时间",sortable:!0,"sort-method":e.sortByDate,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.userJoinTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"管理员",prog:"userAdmin",filters:[{text:"是",value:!0},{text:"否",value:!1}],"filter-method":e.filterAdmin,"filter-placement":"bottom-end",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{size:"medium",type:!0===t.row.userAdmin?"primary":"success","disable-transitions":""}},[e._v(e._s(e._f("formatAdmin")(t.row.userAdmin)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"账户状态",prog:"userStop",filters:[{text:"正常",value:!1},{text:"封停",value:!0}],"filter-method":e.filterStop,"filter-placement":"bottom-end",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{size:"medium",type:!0===t.row.userStop?"danger":"primary"}},[e._v(e._s(e._f("formatStop")(t.row.userStop)))])]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.user.length},on:{"current-change":e.handleCurrentChange}})],1)])},staticRenderFns:[]};var q=s("VU/8")(W,J,!1,function(e){s("aemg")},null,null).exports,Y={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-view")],1)},staticRenderFns:[]};var K=s("VU/8")({name:"userManage",data:function(){return{}},created:function(){},methods:{}},Y,!1,function(e){s("3Uzm")},"data-v-b4ec0878",null).exports,G={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n\tuserManageIndex\n")])},staticRenderFns:[]};var X=s("VU/8")({name:"userManageIndex",data:function(){return{}},created:function(){},methods:{}},G,!1,function(e){s("F3Yw")},"data-v-42213da5",null).exports,Z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"btn-form"},[s("h2",[e._v("添加用户")]),e._v(" "),s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"85px",size:"mini"}},[s("el-form-item",{attrs:{label:"头像"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{name:"file",action:"api/upload/user","before-upload":e.handleBeforeUpload,"on-success":e.handleSuccess}},[e.form.userImg?s("img",{staticClass:"avatar",attrs:{src:e.form.userImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),e.form.userImg?s("span",[e._v("点击更换头像")]):s("span",[e._v("点击添加头像")])],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"邮箱"}},[s("el-input",{model:{value:e.form.userMail,callback:function(t){e.$set(e.form,"userMail",t)},expression:"form.userMail"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"密码"}},[s("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),e._v(" "),s("span",[e._v("限制在6个字符以上")])],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"手机"}},[s("el-input",{model:{value:e.form.userPhone,callback:function(t){e.$set(e.form,"userPhone",t)},expression:"form.userPhone"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"城市"}},[s("el-input",{model:{value:e.form.userCity,callback:function(t){e.$set(e.form,"userCity",t)},expression:"form.userCity"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"铭言"}},[s("el-input",{model:{value:e.form.userMotto,callback:function(t){e.$set(e.form,"userMotto",t)},expression:"form.userMotto"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"用户状态"}},[s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"是否管理员"}},[[s("el-radio-group",{model:{value:e.form.userAdmin,callback:function(t){e.$set(e.form,"userAdmin",t)},expression:"form.userAdmin"}},[s("el-radio",{attrs:{label:!0}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:!1}},[e._v("否")])],1)]],2)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"账户状态"}},[[s("el-radio-group",{model:{value:e.form.userStop,callback:function(t){e.$set(e.form,"userStop",t)},expression:"form.userStop"}},[s("el-radio",{attrs:{label:!0}},[e._v("封停")]),e._v(" "),s("el-radio",{attrs:{label:!1}},[e._v("正常")])],1)]],2)],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"简介"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.userDescription,callback:function(t){e.$set(e.form,"userDescription",t)},expression:"form.userDescription"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"标签"}},[s("el-input",{model:{value:e.form.userLabel,callback:function(t){e.$set(e.form,"userLabel",t)},expression:"form.userLabel"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("添加新用户")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onRest}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var Q=s("VU/8")({name:"userAdd",data:function(){return{form:{userImg:"",userMail:"",username:"",password:"",userPhone:"",userCity:"",userMotto:"",userAdmin:"",userStop:"",userDescription:"",userLabel:""}}},created:function(){},methods:{handleSuccess:function(e,t,s){this.form.userImg=e.data},handleBeforeUpload:function(e){return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("user")?(this.mes.errorMessage("上传的头像图片命名必须包含user"),!1):void 0:(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},onSubmit:function(){var e=this;if(""==this.form.username||""==this.form.password||""==this.form.userMail)return this.mes.errorMessage("用户名、手机号、密码不能为空");this.axios.post("api/admin/register",this.form).then(function(t){if(1==t.data.status)return e.mes.errorMessage(t.data.message);e.mes.successMessage(t.data.message),e.onRest()})},onRest:function(){this.form={userImg:"",userMail:"",username:"",password:"",userPhone:"",userCity:"",userMotto:"",userAdmin:"",userStop:"",userDescription:"",userLabel:""}}}},Z,!1,function(e){s("qDol")},null,null).exports,ee=s("Xxa5"),te=s.n(ee),se=s("exGp"),ae=s.n(se),ie={name:"userRev",data:function(){return{user:[],search:"",pagesize:10,userList:[],multipleSelection:[],flag:!0,form:{userImg:"",userMail:"",username:"",password:"",userPhone:"",userCity:"",userMotto:"",userJoinTime:"",userAdmin:"",userStop:"",userDescription:"",userLabel:""}}},created:function(){this.getData()},filters:{formatAdmin:function(e){return e?"是":"否"},formatStop:function(e){return e?"封停":"正常"}},methods:{sortByDate:function(e,t){return e.userJoinTime-t.userJoinTime},filterAdmin:function(e,t){return t.userAdmin===e},filterStop:function(e,t){return t.userStop===e},handleCurrentChange:function(e){this.getuserList(e,this.pagesize)},handleSelectionChange:function(e){this.multipleSelection=e},handleAvatarSuccess:function(e,t,s){var a=this;this.form.userImg=e.data,this.axios.post("api/users/updateUser",{user_id:this.form._id,flay:6,userImg:e.data}).then(function(e){0==e.data.status&&a.getData()})},beforeAvatarUpload:function(e){var t=this;return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("user")?(this.mes.errorMessage("上传的头像图片命名必须包含user"),!1):""==this.form.userImg?(this.mes.errorMessage("图片为空"),!1):void(-1==this.form.userImg.indexOf("default")&&this.axios.post("/api/upload/userDel",{username:this.form.userImg}).then(function(e){0==e.data.status||t.mes.errorMessage(e.data.message)})):(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},getData:function(){var e=this,t=localStorage.username,s=localStorage.token,a=localStorage._id;this.axios.post("api/admin/showUser",{username:t,token:s,id:a}).then(function(t){e.user=t.data.data,e.getuserList(1,10)})},getuserList:function(e,t){this.userList=this.user.slice((e-1)*t,e*t)},handleEdit:function(e,t){this.flag=!1,this.form=t},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个用户, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){-1==t.userImg.indexOf("default")?s.axios.all([s.axios.post("/api/upload/userDel",{username:t.userImg}),s.axios.post("api/admin/delUser",{username:localStorage.username,token:localStorage.token,id:localStorage._id,_id:t._id})]).then(s.axios.spread(function(e,t){0==e.data.status&&0==t.data.status?(s.mes.successMessage("删除成功"),s.getData()):(s.mes.errorMessage(e.data.message),s.mes.errorMessage(t.data.message))})):s.axios.post("api/admin/delUser",{username:localStorage.username,token:localStorage.token,id:localStorage._id,_id:t._id}).then(function(e){0==e.data.status?(s.mes.successMessage("删除成功"),s.getData()):s.mes.errorMessage(e.data.message)})}).catch(function(){s.mes.promptMessage("已取消")})},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有用户, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){-1==t.userImg.indexOf("default")?e.axios.all([e.axios.post("/api/upload/userDel",{username:t.userImg}),e.axios.post("api/admin/delUser",{username:localStorage.username,token:localStorage.token,id:localStorage._id,_id:t._id})]).then(e.axios.spread(function(t,s){0==t.data.status&&0==s.data.status?e.mes.successMessage("删除成功"):(e.mes.$errorMessage(t.data.message),e.mes.$errorMessage(s.data.message))})):e.axios.post("api/admin/delUser",{username:localStorage.username,token:localStorage.token,id:localStorage._id,_id:t._id}).then(function(t){0==t.data.status?(e.mes.successMessage("删除成功"),e.getData()):e.mes.errorMessage(t.data.message)})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},onSubmit:function(){var e=this;if(""==this.form.username||""==this.form.userPhone)return this.mes.promptMessage("用户名和邮箱不能为空");var t=this.form;this.axios.post("api/admin/updateUser",t).then(function(t){0==t.data.status?(e.mes.successMessage("更新成功"),e.getData(),e.flag=!0):e.mes.errorMessage(t.data.message)})}}},ne={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.flag?s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("router-link",{attrs:{to:{path:"/adminPage/user/userManage/userAdd"}}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 添加用户")])],1),s("router-link",{attrs:{to:{path:"/adminPage/user/userAll"}}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 全部用户")])],1),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入姓名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userList.filter(function(t){return!e.search||t.username.toLowerCase().includes(e.search.toLowerCase())}),border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userImg",label:"头像",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.userImg}})]}}],null,!1,2917197490)}),e._v(" "),s("el-table-column",{attrs:{label:"用户名",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{size:"medium"}},[e._v("\n\t\t\t    \t\t\t"+e._s(t.row.username)+"\n\t\t\t    \t\t")])]}}],null,!1,659786582)}),e._v(" "),s("el-table-column",{attrs:{prop:"userMail",label:"邮箱",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userCity",label:"地址",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{label:"注册时间",sortable:!0,"sort-method":e.sortByDate,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.userJoinTime)))])]}}],null,!1,2466658336)}),e._v(" "),s("el-table-column",{attrs:{label:"管理员",prog:"userAdmin",filters:[{text:"是",value:!0},{text:"否",value:!1}],"filter-method":e.filterAdmin,"filter-placement":"bottom-end",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{size:"medium",type:!0===t.row.userAdmin?"primary":"success","disable-transitions":""}},[e._v(e._s(e._f("formatAdmin")(t.row.userAdmin)))])]}}],null,!1,3570732225)}),e._v(" "),s("el-table-column",{attrs:{label:"账户状态",prog:"userStop",filters:[{text:"正常",value:!1},{text:"封停",value:!0}],"filter-method":e.filterStop,"filter-placement":"bottom-end",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{size:"medium",type:!0===t.row.userStop?"danger":"primary"}},[e._v(e._s(e._f("formatStop")(t.row.userStop)))])]}}],null,!1,697409245)}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,268720131)})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.user.length},on:{"current-change":e.handleCurrentChange}})],1)],1):s("div",{staticClass:"btn-form"},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"85px",size:"mini"}},[s("el-form-item",{attrs:{label:"头像"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{name:"file",action:"api/upload/user","on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.userImg?s("img",{staticClass:"avatar",attrs:{src:e.form.userImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),s("span",[e._v("点击更换头像")])],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"邮箱"}},[s("el-input",{model:{value:e.form.userMail,callback:function(t){e.$set(e.form,"userMail",t)},expression:"form.userMail"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"密码"}},[s("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),e._v(" "),s("span",[e._v("限制在6个字符以上")])],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"手机"}},[s("el-input",{model:{value:e.form.userPhone,callback:function(t){e.$set(e.form,"userPhone",t)},expression:"form.userPhone"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"城市"}},[s("el-input",{model:{value:e.form.userCity,callback:function(t){e.$set(e.form,"userCity",t)},expression:"form.userCity"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"铭言"}},[s("el-input",{model:{value:e.form.userMotto,callback:function(t){e.$set(e.form,"userMotto",t)},expression:"form.userMotto"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"注册时间"}},[s("el-input",{attrs:{disabled:""},model:{value:e.form.userJoinTime,callback:function(t){e.$set(e.form,"userJoinTime",t)},expression:"form.userJoinTime"}}),e._v(" "),s("span",[e._v("注册时间不能进行更改")])],1),e._v(" "),s("el-form-item",{attrs:{label:"用户状态"}},[s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"是否管理员"}},[[s("el-radio-group",{model:{value:e.form.userAdmin,callback:function(t){e.$set(e.form,"userAdmin",t)},expression:"form.userAdmin"}},[s("el-radio",{attrs:{label:!0}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:!1}},[e._v("否")])],1)]],2)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"账户状态"}},[[s("el-radio-group",{model:{value:e.form.userStop,callback:function(t){e.$set(e.form,"userStop",t)},expression:"form.userStop"}},[s("el-radio",{attrs:{label:!0}},[e._v("封停")]),e._v(" "),s("el-radio",{attrs:{label:!1}},[e._v("正常")])],1)]],2)],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"简介"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.userDescription,callback:function(t){e.$set(e.form,"userDescription",t)},expression:"form.userDescription"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"标签"}},[s("el-input",{model:{value:e.form.userLabel,callback:function(t){e.$set(e.form,"userLabel",t)},expression:"form.userLabel"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("更新")])],1)],1)],1)])},staticRenderFns:[]};var re={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-view")],1)},staticRenderFns:[]};var oe={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n\twebsiteBuiltIndex\n")])},staticRenderFns:[]};var le={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-view")],1)},staticRenderFns:[]};var ce={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n\twebsiteIndexIndex\n")])},staticRenderFns:[]};var ue={name:"planting",data:function(){return{imagesList:[],dialogFormVisible:!1,form:{recommendScr:"",recommendImg:"",recommendTitle:""},form1:{_id:"",recommendScr:"",recommendImg:"",recommendTitle:""}}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.get("api/admin/showIndex").then(function(t){e.imagesList=t.data.data})},handleEdit:function(e,t){this.dialogFormVisible=!0,this.form1=t},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个轮播图, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.all([s.axios.post("api/upload/platingDel",{username:t.recommendImg}),s.axios.post("api/admin/delRecommend",{token:localStorage.token,username:localStorage.username,id:localStorage._id,recommendId:t._id})]).then(s.axios.spread(function(e,t){0==e.data.status&&0==t.data.status?(s.mes.successMessage("删除成功"),s.getData()):(s.mes.errorMessage(e.data.message),s.mes.errorMessage(t.data.message))}))}).catch(function(){s.mes.promptMessage("已取消")})},handleREBeforeUpload:function(e){var t=this;return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("index")?(this.mes.errorMessage("上传的头像图片命名必须包含index"),!1):""==this.form1.recommendImg?this.mes.errorMessage("图片为空"):void this.axios.post("api/upload/platingDel",{username:this.form1.recommendImg}).then(function(e){if(0!=e.data.status)return t.mes.errorMessage(e.data.message)}):(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},handleReSuccess:function(e,t,s){this.form1.recommendImg=e.data},handleBeforeUpload:function(e){return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("index")?(this.mes.errorMessage("上传的头像图片命名必须包含index"),!1):void 0:(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},handleSuccess:function(e,t,s){this.form.recommendImg=e.data},onEdit:function(){var e=this;this.axios.post("api/admin/updateRecommend",{token:localStorage.token,username:localStorage.username,id:localStorage._id,recommendScr:this.form1.recommendScr,recommendImg:this.form1.recommendImg,recommendTitle:this.form1.recommendTitle,recommendId:this.form1._id}).then(function(t){if(1==t.data.status)return e.mes.errorMessage(t.data.message);e.mes.successMessage("修改成功"),e.dialogFormVisible=!1,e.getData()})},onSubmit:function(){var e=this;if(""==this.form.recommendImg)return this.mes.errorMessage("照片未上传成功");this.axios.post("api/admin/addRecommend",{token:localStorage.token,username:localStorage.username,id:localStorage._id,recommendScr:this.form.recommendScr,recommendImg:this.form.recommendImg,recommendTitle:this.form.recommendTitle}).then(function(t){if(1==t.data.status)return e.mes.errorMessage(t.data.message);e.mes.successMessage("添加成功"),e.getData(),e.form={recommendScr:"",recommendImg:"",recommendTitle:""}})}}},me={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("h2",[e._v("首页轮播图")]),e._v(" "),s("el-row",{attrs:{gutter:50}},[s("el-col",{staticClass:"left",attrs:{span:16}},[s("el-table",{attrs:{data:e.imagesList,border:""}},[s("el-table-column",{attrs:{type:"index"}}),e._v(" "),s("el-table-column",{attrs:{label:"图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{height:"40px"},attrs:{src:e.row.recommendImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"链接",prop:"recommendScr"}}),e._v(" "),s("el-table-column",{attrs:{label:"文字",prop:"recommendTitle"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("el-dialog",{attrs:{title:"修改轮播图",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{ref:"form1",attrs:{"label-width":"85px",size:"mini",model:e.form1}},[s("el-form-item",{attrs:{label:"轮播图"}},[s("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{name:"file",action:"api/upload/plating","before-upload":e.handleREBeforeUpload,"on-success":e.handleReSuccess}},[e.form1.recommendImg?s("img",{staticClass:"avatar",attrs:{src:e.form1.recommendImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),e.form1.recommendImg?s("span",[e._v("点击更换轮播图")]):s("span",[e._v("点击添加轮播图")])],1),e._v(" "),s("el-form-item",{attrs:{label:"链接"}},[s("el-input",{model:{value:e.form1.recommendScr,callback:function(t){e.$set(e.form1,"recommendScr",t)},expression:"form1.recommendScr"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{model:{value:e.form1.recommendTitle,callback:function(t){e.$set(e.form1,"recommendTitle",t)},expression:"form1.recommendTitle"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onEdit}},[e._v("确 定")])],1)],1)],1),e._v(" "),s("el-col",{staticClass:"right",attrs:{span:8}},[s("h3",[e._v("添加轮播图")]),e._v(" "),s("el-form",{ref:"form",attrs:{"label-width":"85px",size:"mini",model:e.form}},[s("el-form-item",{attrs:{label:"轮播图"}},[s("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{name:"file",action:"api/upload/plating","before-upload":e.handleBeforeUpload,"on-success":e.handleSuccess}},[e.form.recommendImg?s("img",{staticClass:"avatar",attrs:{src:e.form.recommendImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),e.form.recommendImg?s("span",[e._v("点击更换轮播图")]):s("span",[e._v("点击添加轮播图")])],1),e._v(" "),s("el-form-item",{attrs:{label:"链接"}},[s("el-input",{model:{value:e.form.recommendScr,callback:function(t){e.$set(e.form,"recommendScr",t)},expression:"form.recommendScr"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{model:{value:e.form.recommendTitle,callback:function(t){e.$set(e.form,"recommendTitle",t)},expression:"form.recommendTitle"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("\n\t\t\t\t\t\t提交\n\t\t\t\t\t")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var de={name:"websiteNotice",data:function(){return{form:{title:"",context:""},form1:{titlw:"",context:"",_id:"",time:""},dialogFormVisible:!1,notice:[],noticeList:[],search:"",pagesize:10,multipleSelection:[]}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.get("api/showNotice").then(function(t){0==t.data.status?(e.notice=t.data.data,e.getnoticeList(1,e.pagesize)):e.mes.errorMessage("出现错误")})},onSubmit:function(){var e=this;this.axios.post("api/admin/noticeAdd",{username:localStorage.username,token:localStorage.token,id:localStorage._id,title:this.form.title,context:this.form.context}).then(function(t){0==t.data.status?(e.mes.successMessage("添加成功"),e.form={title:"",context:""},e.getData()):e.mes.errorMessage(t.data.message)})},sortByDate:function(e,t){return e.time-t.time},getnoticeList:function(e,t){this.noticeList=this.notice.slice((e-1)*t,e*t)},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有公告, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=localStorage.username,s=localStorage.token,a=localStorage._id;e.multipleSelection.forEach(function(i){e.axios.post("api/admin/noticeDel",{username:t,token:s,id:a,noticeId:i._id}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):e.mes.successMessage("删除成功")})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个公告, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=localStorage.username,a=localStorage.token,i=localStorage._id,n=t._id;s.axios.post("api/admin/noticeDel",{username:e,token:a,id:i,noticeId:n}).then(function(e){0==e.data.status&&(s.mes.successMessage("删除成功"),s.getData())})}).catch(function(){s.mes.promptMessage("已取消")})},handleEdit:function(e){this.form1=e,this.dialogFormVisible=!0},onEdit:function(){var e=this;this.axios.post("api/admin/noticeUpdate",{username:localStorage.username,id:localStorage._id,token:localStorage.token,noticeId:this.form1._id,title:this.form1.title,context:this.form1.context}).then(function(t){0==t.data.status?(e.mes.successMessage("修改成功"),e.dialogFormVisible=!1,e.getData()):e.mes.errorMessage(t.data.message)})},handleCurrentChange:function(e){this.getnoticeList(e,this.pagesize)},handleSelectionChange:function(e){this.multipleSelection=e}}},fe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"main"},[s("h2",[e._v("首页公告")]),e._v(" "),s("el-row",{attrs:{gutter:50}},[s("el-col",{staticClass:"left",attrs:{span:16}},[s("div",{staticClass:"btn"},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入标题进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{attrs:{data:e.noticeList.filter(function(t){return!e.search||t.title.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"标题",prop:"title",align:"center",width:"150"}}),e._v(" "),s("el-table-column",{attrs:{label:"内容",prop:"context",align:"center",width:"190"}}),e._v(" "),s("el-table-column",{attrs:{label:"公布时间",width:"190",align:"center",sortable:!0,"sort-method":e.sortByDate},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("el-dialog",{attrs:{title:"修改公告",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{ref:"form1",attrs:{"label-width":"85px",size:"mini",model:e.form1}},[s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{model:{value:e.form1.title,callback:function(t){e.$set(e.form1,"title",t)},expression:"form1.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"内容"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form1.context,callback:function(t){e.$set(e.form1,"context",t)},expression:"form1.context"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"发布时间"}},[s("el-input",{attrs:{disabled:""},model:{value:e.form1.time,callback:function(t){e.$set(e.form1,"time",t)},expression:"form1.time"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onEdit}},[e._v("确 定")])],1)],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.notice.length},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),s("el-col",{staticClass:"right",attrs:{span:8}},[s("h3",[e._v("添加首页公告")]),e._v(" "),s("el-form",{ref:"form",attrs:{"label-width":"85px",size:"mini",model:e.form}},[s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"内容"}},[s("el-input",{model:{value:e.form.context,callback:function(t){e.$set(e.form,"context",t)},expression:"form.context"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("\n\t\t\t\t\t\t提交\n\t\t\t\t\t")])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var pe={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-view")],1)},staticRenderFns:[]};var ve={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n\tmovieIndex\n")])},staticRenderFns:[]};var he={name:"movieDetail",data:function(){return{movies:[],moviesList:[],pagesize:5,search:"",flag:!0,multipleSelection:[],form:{_id:"",movieImg:"",movieName:"",movieDirector:"",movieWrite:"",movieActor:"",movieDuration:"",movieShowTime:"",movieTopic:"",movieCountry:"",movieVideo:"",movieDownload:"",movieDetail:""}}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.get("api/showRanking").then(function(t){e.movies=t.data.data,e.getmoviesList(1,e.pagesize)})},handleAvatarSuccess:function(e,t,s){this.form.movieImg=e.data},beforeAvatarUpload:function(e){var t=this;return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("movie")?(this.mes.errorMessage("上传的头像图片命名必须包含movie"),!1):""==this.form.movieImg?this.mes.errorMessage("没有图片"):void this.axios.post("api/upload/movieDel",{username:this.form.movieImg}).then(function(e){if(0!=e.data.status)return t.mes.errorMessage(e.data.message)}):(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},handleEdit:function(e,t){this.flag=!1,this.form=t},onEdit:function(){var e=this;this.axios.post("api/admin/movieUpdate",l()({token:localStorage.token,id:localStorage._id,username:localStorage.username},this.form)).then(function(t){if(1==t.data.status)return e.mes.errorMessage(t.data.message);e.flag=!0,e.mes.successMessage("更新成功")})},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个电影, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.all([s.axios.post("api/upload/movieDel",{username:t.movieImg}),s.axios.post("api/admin/movieDel",{username:localStorage.username,token:localStorage.token,id:localStorage._id,movieId:t._id})]).then(s.axios.spread(function(e,t){0==e.data.status&&0==t.data.status?(s.mes.successMessage("删除成功"),console.log(e),console.log(t),s.getData()):(s.mes.errorMessage(e.data.message),s.mes.errorMessage(t.data.message))}))}).catch(function(){s.mes.promptMessage("已取消")})},getmoviesList:function(e,t){this.moviesList=this.movies.slice((e-1)*t,e*t)},handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.getmoviesList(e,this.pagesize)},sortByDate:function(e,t){return e.movieShowTime-t.movieShowTime},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有电影, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.all([e.axios.post("api/upload/movieDel",{username:t.movieImg}),e.axios.post("api/admin/movieDel",{username:localStorage.username,token:localStorage.token,id:localStorage._id,movieId:t._id})]).then(e.axios.spread(function(t,s){0==t.data.status&&0==s.data.status?e.mes.successMessage("删除成功"):(e.mes.errorMessage(t.data.message),e.mes.errorMessage(s.data.message))}))}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()}}},ge={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.flag?s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("router-link",{attrs:{to:{path:"/adminPage/websiteBuilt/movie/movieAdd"}}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 添加电影")])],1),s("router-link",{attrs:{to:{path:"/adminPage/websiteBuilt/movie/movieActivity"}}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 电影活动")])],1),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入电影名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.moviesList.filter(function(t){return!e.search||t.movieName.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"expand",label:"其他",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[s("el-form-item",{attrs:{label:"剧情简介"}},[s("span",[e._v(e._s(t.row.movieDetail))])])],1)]}}],null,!1,1754384328)}),e._v(" "),s("el-table-column",{attrs:{type:"selection",align:"center",width:"40"}}),e._v(" "),s("el-table-column",{attrs:{label:"海报",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"20px"},attrs:{src:e.row.movieImg}})]}}],null,!1,2445854202)}),e._v(" "),s("el-table-column",{attrs:{label:"电影名",prop:"movieName",width:"150",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"电影导演",prop:"movieDirector",width:"100",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"电影演员",prop:"movieActor",width:"200",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"电影时常",prop:"movieDuration",width:"100",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"国家",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(t.row.movieCountry))])]}}],null,!1,1565274660)}),e._v(" "),s("el-table-column",{attrs:{label:"放映时间",sortable:!0,"sort-method":e.sortByDate,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.movieShowTime)))])]}}],null,!1,2644249992)}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,2871703617)})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.movies.length},on:{"current-change":e.handleCurrentChange}})],1)],1):s("div",{staticClass:"btn-form"},[s("h2",[e._v("修改电影信息")]),e._v(" "),s("el-form",{ref:"form1",attrs:{"label-width":"100px",size:"mini",model:e.form}},[s("el-form-item",{attrs:{label:"宣传海报"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{name:"file",action:"api/upload/movie","on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.movieImg?s("img",{staticClass:"avatar",attrs:{src:e.form.movieImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),s("span",[e._v("点击更改宣传海报")])],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影名"}},[s("el-input",{model:{value:e.form.movieName,callback:function(t){e.$set(e.form,"movieName",t)},expression:"form.movieName"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"导演"}},[s("el-input",{model:{value:e.form.movieDirector,callback:function(t){e.$set(e.form,"movieDirector",t)},expression:"form.movieDirector"}}),e._v(" "),s("span",[e._v("中间以“/”隔开")])],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"编剧"}},[s("el-input",{model:{value:e.form.movieWrite,callback:function(t){e.$set(e.form,"movieWrite",t)},expression:"form.movieWrite"}}),e._v(" "),s("span",[e._v("中间以“/”隔开")])],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"演员"}},[s("el-input",{model:{value:e.form.movieActor,callback:function(t){e.$set(e.form,"movieActor",t)},expression:"form.movieActor"}}),e._v(" "),s("span",[e._v("中间以“/”隔开")])],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影时常"}},[s("el-input",{model:{value:e.form.movieDuration,callback:function(t){e.$set(e.form,"movieDuration",t)},expression:"form.movieDuration"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"上映时间"}},[s("el-input",{model:{value:e.form.movieShowTime,callback:function(t){e.$set(e.form,"movieShowTime",t)},expression:"form.movieShowTime"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影分类"}},[s("el-input",{model:{value:e.form.movieTopic,callback:function(t){e.$set(e.form,"movieTopic",t)},expression:"form.movieTopic"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"片源地"}},[s("el-input",{model:{value:e.form.movieCountry,callback:function(t){e.$set(e.form,"movieCountry",t)},expression:"form.movieCountry"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影视频地址"}},[s("el-input",{model:{value:e.form.movieVideo,callback:function(t){e.$set(e.form,"movieVideo",t)},expression:"form.movieVideo"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影下载地址"}},[s("el-input",{model:{value:e.form.movieDownload,callback:function(t){e.$set(e.form,"movieDownload",t)},expression:"form.movieDownload"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"电影剧情"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.movieDetail,callback:function(t){e.$set(e.form,"movieDetail",t)},expression:"form.movieDetail"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onEdit}},[e._v("\n\t\t\t\t\t更新\n\t\t\t\t")])],1)],1)],1)])},staticRenderFns:[]};var _e={name:"movieAdd",data:function(){return{form:{movieImg:"",movieName:"",movieDirector:"",movieWrite:"",movieActor:"",movieDuration:"",movieShowTime:"",movieTopic:"",movieCountry:"",movieVideo:"",movieDownload:"",movieDetail:""}}},created:function(){},methods:{handleAvatarSuccess:function(e,t,s){this.form.movieImg=e.data},beforeAvatarUpload:function(e){return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("movie")?(this.mes.errorMessage("上传的头像图片命名必须包含movie"),!1):void 0:(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},onSubmit:function(){var e=this;this.axios.post("api/admin/movieAdd",l()({username:localStorage.username,token:localStorage.token,id:localStorage._id},this.form)).then(function(t){if(1==t.data.status)return e.mes.errorMessage(t.data.message);e.mes.successMessage("添加成功"),e.form={movieImg:"",movieName:"",movieDirector:"",movieWrite:"",movieActor:"",movieDuration:"",movieShowTime:"",movieTopic:"",movieCountry:"",movieVideo:"",movieDownload:"",movieDetail:""}})}}},be={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("h3",[e._v("添加电影")]),e._v(" "),s("el-form",{ref:"form",attrs:{"label-width":"100px",size:"mini",model:e.form}},[s("el-form-item",{attrs:{label:"宣传海报"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{name:"file",action:"api/upload/movie","on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.movieImg?s("img",{staticClass:"avatar",attrs:{src:e.form.movieImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),e.form.movieImg?s("span",[e._v("点击更换宣传海报")]):s("span",[e._v("点击添加宣传海报")])],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影名"}},[s("el-input",{model:{value:e.form.movieName,callback:function(t){e.$set(e.form,"movieName",t)},expression:"form.movieName"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"导演"}},[s("el-input",{model:{value:e.form.movieDirector,callback:function(t){e.$set(e.form,"movieDirector",t)},expression:"form.movieDirector"}}),e._v(" "),s("span",[e._v("中间以“/”隔开")])],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"编剧"}},[s("el-input",{model:{value:e.form.movieWrite,callback:function(t){e.$set(e.form,"movieWrite",t)},expression:"form.movieWrite"}}),e._v(" "),s("span",[e._v("中间以“/”隔开")])],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"演员"}},[s("el-input",{model:{value:e.form.movieActor,callback:function(t){e.$set(e.form,"movieActor",t)},expression:"form.movieActor"}}),e._v(" "),s("span",[e._v("中间以“/”隔开")])],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影时常"}},[s("el-input",{model:{value:e.form.movieDuration,callback:function(t){e.$set(e.form,"movieDuration",t)},expression:"form.movieDuration"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"上映时间"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择上映时间"},model:{value:e.form.movieShowTime,callback:function(t){e.$set(e.form,"movieShowTime",t)},expression:"form.movieShowTime"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影分类"}},[s("el-input",{model:{value:e.form.movieTopic,callback:function(t){e.$set(e.form,"movieTopic",t)},expression:"form.movieTopic"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"片源地"}},[s("el-input",{model:{value:e.form.movieCountry,callback:function(t){e.$set(e.form,"movieCountry",t)},expression:"form.movieCountry"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影视频地址"}},[s("el-input",{model:{value:e.form.movieVideo,callback:function(t){e.$set(e.form,"movieVideo",t)},expression:"form.movieVideo"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"电影下载地址"}},[s("el-input",{model:{value:e.form.movieDownload,callback:function(t){e.$set(e.form,"movieDownload",t)},expression:"form.movieDownload"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"电影剧情"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.movieDetail,callback:function(t){e.$set(e.form,"movieDetail",t)},expression:"form.movieDetail"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("\n\t\t\t\t\t提交\n\t\t\t\t")])],1)],1)],1)},staticRenderFns:[]};var xe={name:"movieActivity",data:function(){return{form:{title:"",context:"",startTime:""},form1:{title:"",context:"",_id:"",startTime:""},dialogFormVisible:!1,activity:[],activityList:[],search:"",pagesize:5,multipleSelection:[]}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.get("api/showActivity").then(function(t){0==t.data.status?(e.activity=t.data.data,e.getactivityList(1,e.pagesize)):e.mes.errorMessage("出现错误")})},onSubmit:function(){var e=this;this.axios.post("api/admin/activityAdd",{username:localStorage.username,token:localStorage.token,id:localStorage._id,title:this.form.title,context:this.form.context,startTime:this.form.startTime.getTime()}).then(function(t){0==t.data.status?(e.mes.successMessage("添加成功"),e.form={title:"",context:"",startTime:""},e.getData()):e.mes.errorMessage(t.data.message)})},sortByDate:function(e,t){return e.startTime-t.startTime},getactivityList:function(e,t){this.activityList=this.activity.slice((e-1)*t,e*t)},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有活动, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=localStorage.username,s=localStorage.token,a=localStorage._id;e.multipleSelection.forEach(function(i){e.axios.post("api/admin/activityDel",{username:t,token:s,id:a,activityId:i._id}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):e.mes.successMessage("删除成功")})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个活动, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=localStorage.username,a=localStorage.token,i=localStorage._id;s.axios.post("api/admin/activityDel",{username:e,token:a,id:i,activityId:t._id}).then(function(e){0==e.data.status&&(s.mes.successMessage("删除成功"),s.getData())})}).catch(function(){s.mes.promptMessage("已取消")})},handleEdit:function(e){this.form1=e,this.form1.startTime=new Date(e.startTime),this.dialogFormVisible=!0},onEdit:function(){var e=this;this.axios.post("api/admin/activityUpdate",{username:localStorage.username,id:localStorage._id,token:localStorage.token,activityId:this.form1._id,title:this.form1.title,context:this.form1.context,startTime:this.form1.startTime}).then(function(t){0==t.data.status?(e.mes.successMessage("修改成功"),e.dialogFormVisible=!1,e.getData()):e.mes.errorMessage(t.data.message)})},handleCurrentChange:function(e){this.getnoticeList(e,this.pagesize)},handleSelectionChange:function(e){this.multipleSelection=e}}},we={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"main"},[s("h2",[e._v("电影活动")]),e._v(" "),s("el-row",{attrs:{gutter:50}},[s("el-col",{staticClass:"left",attrs:{span:16}},[s("div",{staticClass:"btn"},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入标题进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{attrs:{data:e.activityList.filter(function(t){return!e.search||t.title.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"标题",prop:"title",align:"center",width:"170"}}),e._v(" "),s("el-table-column",{attrs:{label:"活动内容",prop:"context",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"活动时间",align:"center",sortable:!0,"sort-method":e.sortByDate},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.startTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("el-dialog",{attrs:{title:"修改电影活动",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{ref:"form1",attrs:{"label-width":"85px",size:"mini",model:e.form1}},[s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{model:{value:e.form1.title,callback:function(t){e.$set(e.form1,"title",t)},expression:"form1.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"活动内容"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form1.context,callback:function(t){e.$set(e.form1,"context",t)},expression:"form1.context"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"活动时间"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form1.startTime,callback:function(t){e.$set(e.form1,"startTime",t)},expression:"form1.startTime"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onEdit}},[e._v("确 定")])],1)],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.activity.length},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),s("el-col",{staticClass:"right",attrs:{span:8}},[s("h3",[e._v("添加电影活动")]),e._v(" "),s("el-form",{ref:"form",attrs:{"label-width":"85px",size:"mini",model:e.form}},[s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"活动时间"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"活动内容"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.context,callback:function(t){e.$set(e.form,"context",t)},expression:"form.context"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("\n\t\t\t\t\t\t\t提交\n\t\t\t\t\t\t")])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var Ce={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-view")],1)},staticRenderFns:[]};var ke={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n\tarticleIndex\n")])},staticRenderFns:[]};var ye={name:"articleDetail",data:function(){return{article:[],articleList:[],pagesize:5,search:"",multipleSelection:[],dialogFormVisible:!1,form1:{articleTitle:"",articleContext:"",articleTopic:"",_id:""}}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.get("api/showArticle").then(function(t){e.article=t.data.data,e.getarticleList(1,e.pagesize)})},getarticleList:function(e,t){this.articleList=this.article.slice((e-1)*t,e*t)},handleCurrentChange:function(e){this.getarticleList(e,this.pagesize)},sortByDate:function(e,t){return e.articleTime-t.articleTime},onEdit:function(){var e=this;this.axios.post("api/admin/updateArticle",{token:localStorage.token,id:localStorage._id,username:localStorage.username,articleId:this.form1._id,articleTitle:this.form1.articleTitle,articleContext:this.form1.articleContext,articleTopic:this.form1.articleTopic}).then(function(t){if(0!=t.data.status)return e.mes.errorMessage(t.data.message);e.mes.successMessage("编辑成功"),e.dialogFormVisible=!1,e.form1={articleTitle:"",articleContext:"",articleTopic:"",_id:""}})},handleEdit:function(e,t){this.dialogFormVisible=!0,this.form1=t},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个文章, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.post("api/admin/delArticle",{token:localStorage.token,id:localStorage._id,username:localStorage.username,articleId:t._id}).then(function(e){if(0!=e.data.status)return s.mes.errorMessage(e.data.message);s.mes.successMessage("删除成功"),s.getData()})}).catch(function(){s.mes.promptMessage("已取消")})},handleSelectionChange:function(e){this.multipleSelection=e},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有文章, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.post("api/admin/delArticle",{token:localStorage.token,id:localStorage._id,username:localStorage.username,articleId:t._id}).then(function(t){if(0!=t.data.status)return e.mes.errorMessage(t.data.message);e.mes.successMessage("删除成功")})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()}}},Me={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("router-link",{attrs:{to:{path:"/adminPage/websiteBuilt/article/articleAdd"}}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 添加文章")])],1),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入电影名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.articleList.filter(function(t){return!e.search||t.articleTitle.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"expand",label:"文章详情",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[s("el-form-item",{attrs:{label:"文章详情"}},[s("span",[e._v(e._s(t.row.articleContext))])])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{type:"selection",align:"center",width:"60"}}),e._v(" "),s("el-table-column",{attrs:{label:"文章名",prop:"articleTitle",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"文章分类",prop:"articleTopic",width:"120",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"发布时间",sortable:!0,"sort-method":e.sortByDate,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.articleTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("el-dialog",{attrs:{title:"修改文章",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{ref:"form1",attrs:{"label-width":"85px",size:"mini",model:e.form1}},[s("el-form-item",{attrs:{label:"文章名"}},[s("el-input",{model:{value:e.form1.articleTitle,callback:function(t){e.$set(e.form1,"articleTitle",t)},expression:"form1.articleTitle"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"文章分类"}},[s("el-input",{model:{value:e.form1.articleTopic,callback:function(t){e.$set(e.form1,"articleTopic",t)},expression:"form1.articleTopic"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"文章内容"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form1.articleContext,callback:function(t){e.$set(e.form1,"articleContext",t)},expression:"form1.articleContext"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onEdit}},[e._v("确 定")])],1)],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.article.length},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var Se={name:"articleAdd",data:function(){return{form:{articleTitle:"",articleTopic:"",articleContext:""}}},created:function(){},methods:{onSubmit:function(){var e=this;this.axios.post("api/admin/addArticle",{token:localStorage.token,username:localStorage.username,id:localStorage._id,articleTitle:this.form.articleTitle,articleContext:this.form.articleContext,articleTopic:this.form.articleTopic}).then(function(t){if(0!=t.data.status)return e.mes.errorMessage(t.data.message);e.mes.successMessage("添加成功"),e.form={articleTitle:"",articleTopic:"",articleContext:""}})}}},De={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("h3",[e._v("添加电影")]),e._v(" "),s("el-form",{ref:"form",attrs:{"label-width":"100px",model:e.form}},[s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{model:{value:e.form.articleTitle,callback:function(t){e.$set(e.form,"articleTitle",t)},expression:"form.articleTitle"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"话题"}},[s("el-input",{model:{value:e.form.articleTopic,callback:function(t){e.$set(e.form,"articleTopic",t)},expression:"form.articleTopic"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"文章内容"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.articleContext,callback:function(t){e.$set(e.form,"articleContext",t)},expression:"form.articleContext"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("\n\t\t\t\t提交\n\t\t\t")])],1)],1)],1)},staticRenderFns:[]};var $e={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-view")],1)},staticRenderFns:[]};var Ue={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n\tcommunicationIndex\n")])},staticRenderFns:[]};var Ie={name:"email",data:function(){return{comments:[],search:"",commentsList:[],pagesize:10,multipleSelection:[]}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.comments=[],this.commentsList=[],this.axios.post("api/admin/showEmail",{token:localStorage.token,user_id:localStorage._id}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):t.data.data.map(function(t){e.axios.all([e.axios.post("api/users/userDetail",{user_id:t.fromUser}),e.axios.post("api/users/userDetail",{user_id:t.toUser})]).then(e.axios.spread(function(s,a){t.fromUsername=s.data.data[0].username,t.fromUserImg=s.data.data[0].userImg,t.toUsername=a.data.data[0].username,t.toUserImg=a.data.data[0].userImg,e.comments.push(t),e.getcommentsList(1,e.pagesize)}))})})},onShowContext:function(e){this.$alert(e.context,"邮件内容",{confirmButtonText:"确定"})},sortByDate:function(e,t){return e.userJoinTime-t.userJoinTime},handleCurrentChange:function(e){this.getcommentsList(e,this.pagesize)},getcommentsList:function(e,t){this.commentsList=this.comments.slice((e-1)*t,e*t)},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有邮件, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.post("api/admin/delEmail",{username:localStorage.username,token:localStorage.token,id:localStorage._id,emailId:t._id}).then(function(t){0==t.data.status?e.mes.successMessage("删除成功"):e.mes.errorMessage(t.data.message)})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},handleSelectionChange:function(e){this.multipleSelection=e},handelDelete:function(e,t){var s=this;this.$confirm("将删除这封邮件, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.post("api/admin/delEmail",{username:localStorage.username,token:localStorage.token,id:localStorage._id,emailId:t._id}).then(function(e){0==e.data.status?(s.mes.successMessage("删除成功"),s.getData()):s.mes.errorMessage(e.data.message)})}).catch(function(){s.mes.promptMessage("已取消")})}}},Le={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入发件人姓名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.commentsList.filter(function(t){return!e.search||t.fromUsername.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fromUsername",label:"发件人",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fromUserImg",label:"发件人头像",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.fromUserImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"toUsername",label:"收件人",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"toUserImg",label:"收件人头像",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.toUserImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"发送时间",align:"center",sortable:!0,"sort-method":e.sortByDate},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.sendTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"邮件标题",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticClass:"title",on:{click:function(s){return e.onShowContext(t.row)}}},[e._v(e._s(t.row.title))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",prop:"title"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handelDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.comments.length},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var Te={name:"articleComment",data:function(){return{comments:[],commentsList:[],pagesize:5,multipleSelection:[],search:""}},created:function(){this.getData()},filters:{formatCheck:function(e){return e?"已批准":"审核中"}},methods:{getData:function(){var e=this;this.commentsList=[],this.comments=[],this.axios.get("api/admin/commentsList").then(function(t){t.data.data.filter(function(e){return e.article_id}).map(function(t){e.axios.all([e.axios.post("api/users/userDetail",{username:t.username}),e.axios.post("api/articleDetail",{article_id:t.article_id})]).then(e.axios.spread(function(s,a){t.user_id=s.data.data[0]._id,t.userImg=s.data.data[0].userImg,t.articleTitle=a.data.data[0].articleTitle,e.comments.push(t),console.log(e.comments),e.getcommentsList(1,e.pagesize)}))})})},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.post("api/admin/delComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:t._id}).then(function(t){0==t.data.status?e.mes.successMessage("删除成功"):e.mes.errorMessage(t.data.message)})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.post("api/admin/delComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:t._id}).then(function(e){0==e.data.status?(s.mes.successMessage("删除成功"),s.getData()):s.mes.errorMessage(e.data.message)})}).catch(function(){s.mes.promptMessage("已取消")})},onCheck:function(e,t){var s=this;this.$confirm("将通过这个评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.post("api/admin/checkComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:t._id}).then(function(e){0==e.data.status?(s.mes.successMessage("审核成功"),s.getData()):s.mes.errorMessage(e.data.message)})}).catch(function(){s.mes.promptMessage("已取消")})},onCheckAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将审核所选的所有评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.post("api/admin/checkComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:t._id}).then(function(t){0==t.data.status?e.mes.successMessage("审核成功"):e.mes.errorMessage(t.data.message)})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},getcommentsList:function(e,t){this.commentsList=this.comments.slice((e-1)*t,e*t)},handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.getcommentsList(e,this.pagesize)},sortByDate:function(e,t){return e.userJoinTime-t.userJoinTime},filterCheck:function(e,t){return t.check===e}}},Ee={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入文章名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.commentsList.filter(function(t){return!e.search||t.articleTitle.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"评论人",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userImg",label:"评论人头像",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.userImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"articleTitle",label:"文章",align:"center",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{label:"评论时间",align:"center",sortable:!0,"sort-method":e.sortByDate,width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.commentTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"评论内容",align:"center",prop:"context"}}),e._v(" "),s("el-table-column",{attrs:{label:"审核",prog:"check",filters:[{text:"已批准",value:!0},{text:"审核中",value:!1}],"filter-method":e.filterCheck,"filter-placement":"bottom-end",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.check?s("el-tag",{attrs:{size:"mini",type:"danger","disable-transitions":""}},[e._v("\n\t\t\t\t    \t\t"+e._s(e._f("formatCheck")(t.row.check))+"\n\t\t\t\t    \t\t")]):s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.onCheck(t.$index,t.row)}}},[e._v("\n\t\t\t\t    \t\t\t"+e._s(e._f("formatCheck")(t.row.check))+"\n\t\t\t\t    \t\t")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",prop:"title",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n\t\t\t    \t\t")])]}}])})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.onCheckAll}},[e._v("审核所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.comments.length},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var Ae={name:"movieComment",data:function(){return{comments:[],commentsList:[],pagesize:5,search:"",multipleSelection:[]}},created:function(){this.getData()},filters:{formatCheck:function(e){return e?"已批准":"审核中"}},methods:{filterCheck:function(e,t){return t.check===e},getData:function(){var e=this;this.commentsList=[],this.comments=[],this.axios.get("api/admin/commentsList").then(function(t){t.data.data.filter(function(e){return e.movie_id}).map(function(t){e.axios.all([e.axios.post("api/users/userDetail",{username:t.username}),e.axios.post("api/movieDetail",{movie_id:t.movie_id})]).then(e.axios.spread(function(s,a){t.user_id=s.data.data[0]._id,t.userImg=s.data.data[0].userImg,t.movieName=a.data.data.movieName,e.comments.push(t),e.getcommentsList(1,e.pagesize)}))})})},getcommentsList:function(e,t){this.commentsList=this.comments.slice((e-1)*t,e*t)},handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.getcommentsList(e,this.pagesize)},onCheck:function(e){var t=this;this.$confirm("将通过这个评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.axios.post("api/admin/checkComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:e._id}).then(function(e){0==e.data.status?(t.mes.successMessage("审核成功"),t.getData()):t.mes.errorMessage(e.data.message)})}).catch(function(){t.mes.promptMessage("已取消")})},onCheckAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将审核所选的所有评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.post("api/admin/checkComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:t._id}).then(function(t){0==t.data.status?e.mes.successMessage("审核成功"):e.mes.errorMessage(t.data.message)})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},handleDelete:function(e,t){var s=this;this.$confirm("将删除这个评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.post("api/admin/delComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:t._id}).then(function(e){0==e.data.status?(s.mes.successMessage("删除成功"),s.getData()):s.mes.errorMessage(e.data.message)})}).catch(function(){s.mes.promptMessage("已取消")})},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有评论, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.post("api/admin/delComment",{username:localStorage.username,token:localStorage.token,id:localStorage._id,commentId:t._id}).then(function(t){0==t.data.status?e.mes.successMessage("删除成功"):e.mes.errorMessage(t.data.message)})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},sortByDate:function(e,t){return e.userJoinTime-t.userJoinTime}}},ze={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入电影名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.commentsList.filter(function(t){return!e.search||t.movieName.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"评论人",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userImg",label:"评论人头像",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.userImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"movieName",label:"电影",align:"center",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{label:"留言时间",align:"center",sortable:!0,"sort-method":e.sortByDate,width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.commentTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"留言内容",align:"center",prop:"context"}}),e._v(" "),s("el-table-column",{attrs:{label:"审核",prog:"check",filters:[{text:"已批准",value:!0},{text:"审核中",value:!1}],"filter-method":e.filterCheck,"filter-placement":"bottom-end",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.check?s("el-tag",{attrs:{size:"mini",type:"danger","disable-transitions":""}},[e._v("\n\t\t\t\t    \t\t"+e._s(e._f("formatCheck")(t.row.check))+"\n\t\t\t\t    \t\t")]):s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.onCheck(t.row)}}},[e._v("\n\t\t\t\t    \t\t\t"+e._s(e._f("formatCheck")(t.row.check))+"\n\t\t\t\t    \t\t")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",prop:"title",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n\t\t\t    \t\t")])]}}])})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.onCheckAll}},[e._v("审核所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.comments.length},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var Pe={name:"userInfoComment",data:function(){return{comments:[],commentsList:[],pagesize:5,search:"",multipleSelection:[]}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.commentsList=[],this.comments=[],this.axios.post("api/admin/showMessage",{token:localStorage.token,id:localStorage._id,username:localStorage.username}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):t.data.data.map(function(t){e.axios.all([e.axios.post("api/users/userDetail",{user_id:t.fromUser}),e.axios.post("api/users/userDetail",{user_id:t.toUser})]).then(e.axios.spread(function(s,a){t.fromUsername=s.data.data[0].username,t.fromUserImg=s.data.data[0].userImg,t.toUsername=a.data.data[0].username,t.toUserImg=a.data.data[0].userImg,e.comments.push(t),e.getcommentsList(1,e.pagesize)}))})})},getcommentsList:function(e,t){this.commentsList=this.comments.slice((e-1)*t,e*t)},handleSelectionChange:function(e){this.multipleSelection=e},sortByDate:function(e,t){return e.userJoinTime-t.userJoinTime},handelDelete:function(e,t){var s=this;this.$confirm("将删除这封邮件, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.axios.post("api/admin/delMessage",{username:localStorage.username,token:localStorage.token,id:localStorage._id,messageId:t._id}).then(function(e){0==e.data.status?(s.mes.successMessage("删除成功"),s.getData()):s.mes.errorMessage(e.data.message)})}).catch(function(){s.mes.promptMessage("已取消")})},handleDeleteAll:function(){var e=this;return ae()(te.a.mark(function t(){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.mes.promptMessage("选择框未选择"));case 2:return t.next=4,e.$confirm("将删除所选的所有邮件, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.forEach(function(t){e.axios.post("api/admin/delMessage",{username:localStorage.username,token:localStorage.token,id:localStorage._id,messageId:t._id}).then(function(t){0==t.data.status?e.mes.successMessage("删除成功"):e.mes.errorMessage(t.data.message)})}),e.getData()}).catch(function(){e.mes.promptMessage("已取消")});case 4:case"end":return t.stop()}},t,e)}))()},handleCurrentChange:function(e){this.getcommentsList(e,this.pagesize)}}},Be={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("div",{staticClass:"btn"},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"输入留言人姓名进行查找","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.commentsList.filter(function(t){return!e.search||t.fromUsername.toLowerCase().includes(e.search.toLowerCase())}),border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fromUsername",label:"留言人",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fromUserImg",label:"留言人头像",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.fromUserImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"toUsername",label:"个人主页",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"toUserImg",label:"个人头像",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"30px"},attrs:{src:e.row.toUserImg}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"留言时间",align:"center",sortable:!0,"sort-method":e.sortByDate,width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("forMatTime")(t.row.sendTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"留言内容",align:"center",prop:"context"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",prop:"title",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handelDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.handleDeleteAll}},[e._v("删除所选")]),e._v(" "),s("el-pagination",{attrs:{"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.comments.length},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var Fe=[{path:"/adminPage",name:"adminPage",component:B,meta:{title:"首页"},children:[{path:"",component:V,name:"index"},{path:"user",component:N,name:"user",meta:{title:"用户"},children:[{path:"",component:H,name:"userIndex"},{path:"userAll",component:q,name:"userAll",meta:{title:"全部用户"}},{path:"userManage",component:K,name:"userManage",meta:{title:"用户管理"},children:[{path:"",component:X,name:"userManageIndex"},{path:"userAdd",component:Q,name:"userAdd",meta:{title:"添加用户"}},{path:"userRev",component:s("VU/8")(ie,ne,!1,function(e){s("uO82")},null,null).exports,name:"userRev",meta:{title:"编辑用户"}}]}]},{path:"websiteBuilt",component:s("VU/8")({name:"websiteBuilt",data:function(){return{}},created:function(){},methods:{}},re,!1,function(e){s("Ik35")},"data-v-c33949ae",null).exports,name:"websiteBuilt",meta:{title:"网站建设"},children:[{path:"",component:s("VU/8")({name:"websiteBuiltIndex",data:function(){return{}},created:function(){},methods:{}},oe,!1,function(e){s("5iXh")},"data-v-48c28f23",null).exports,name:"websiteBuiltIndex"},{path:"websiteIndex",component:s("VU/8")({name:"websiteIndex",data:function(){return{}},created:function(){},methods:{}},le,!1,function(e){s("LrLx")},"data-v-5d662de2",null).exports,name:"websiteIndex",meta:{title:"网站首页"},children:[{path:"",component:s("VU/8")({name:"websiteIndexIndex",data:function(){return{}},created:function(){},methods:{}},ce,!1,function(e){s("l81T")},"data-v-c19e933c",null).exports,name:"websiteIndexIndex"},{path:"planting",component:s("VU/8")(ue,me,!1,function(e){s("AAG4"),s("cs8D")},"data-v-114af638",null).exports,name:"planting",meta:{title:"轮播图"}},{path:"websiteNotice",component:s("VU/8")(de,fe,!1,function(e){s("1FOl"),s("3KO8")},"data-v-5b20387e",null).exports,name:"websiteNotice",meta:{title:"网站公告"}}]},{path:"movie",component:s("VU/8")({name:"movie",data:function(){return{}},created:function(){},methods:{}},pe,!1,function(e){s("lcK2")},"data-v-de66cbe0",null).exports,name:"movie",meta:{title:"电影"},children:[{path:"",component:s("VU/8")({name:"movieIndex",data:function(){return{}},created:function(){},methods:{}},ve,!1,function(e){s("xzLO")},"data-v-610327af",null).exports,name:"movieIndex"},{path:"movieDetail",component:s("VU/8")(he,ge,!1,function(e){s("RfpI"),s("YcDP")},"data-v-e86a9fd6",null).exports,name:"movieDetail",meta:{title:"电影详情"}},{path:"movieAdd",component:s("VU/8")(_e,be,!1,function(e){s("INe6"),s("/cd1")},"data-v-fd21a43c",null).exports,name:"movieAdd",meta:{title:"添加电影"}},{path:"movieActivity",component:s("VU/8")(xe,we,!1,function(e){s("xCZg"),s("qS3c")},"data-v-6053e455",null).exports,name:"movieActivity",meta:{title:"电影活动"}}]},{path:"article",component:s("VU/8")({name:"article",data:function(){return{}},created:function(){},methods:{}},Ce,!1,function(e){s("eSeJ")},"data-v-657b3a2e",null).exports,name:"article",meta:{title:"文章"},children:[{path:"",component:s("VU/8")({name:"articleIndex",data:function(){return{}},created:function(){},methods:{}},ke,!1,function(e){s("DXMo")},"data-v-3d56bef5",null).exports,name:"articleIndex"},{path:"articleDetail",component:s("VU/8")(ye,Me,!1,function(e){s("P46r"),s("iwA8")},"data-v-2e5935b0",null).exports,name:"articleDetail",meta:{title:"文章详情"}},{path:"articleAdd",component:s("VU/8")(Se,De,!1,function(e){s("KYD1"),s("70a4")},"data-v-493147ad",null).exports,name:"articleAdd",meta:{title:"添加文章"}}]}]},{path:"communication",component:s("VU/8")({name:"communication",data:function(){return{}},created:function(){},methods:{}},$e,!1,function(e){s("fdAK")},"data-v-6cf79aab",null).exports,name:"communication",meta:{title:"站内通信"},children:[{path:"",component:s("VU/8")({name:"communicationIndex",data:function(){return{}},created:function(){},methods:{}},Ue,!1,function(e){s("XuWr")},"data-v-9dee8590",null).exports,name:"communicationIndex"},{path:"email",component:s("VU/8")(Ie,Le,!1,function(e){s("HBay"),s("+2XG")},"data-v-19f39745",null).exports,name:"email",meta:{title:"站内信"}},{path:"articleComment",component:s("VU/8")(Te,Ee,!1,function(e){s("Ixbm"),s("nkvL")},"data-v-5ae95e8c",null).exports,name:"articleComment",meta:{title:"文章评论"}},{path:"movieComment",component:s("VU/8")(Ae,ze,!1,function(e){s("EZ5W"),s("z6ri")},"data-v-5f468e82",null).exports,name:"movieComment",meta:{title:"电影评论"}},{path:"userInfoComment",component:s("VU/8")(Pe,Be,!1,function(e){s("vFM9"),s("LDYG")},"data-v-74daffd3",null).exports,name:"userInfoComment",meta:{title:"主页留言"}}]}]}],Re={data:function(){return{form:{username:"",password:"",repassword:"",userMail:"",userPhone:""},flagUsername:!1,usernameMessage:" 至少使用六个字母、数字、下划线，且第一位是字母 ",flagPassword:!1,passwordMessage:" 至少使用六个字母、数字、下划线，且第一位是字母 ",flagRepassword:!1,repasswordMessage:" 请确认两次密码相同 ",flagUserPhone:!1,userPhoneMessage:"",flagUserMail:!1,userMailMessage:""}},methods:{usernameOnInput:function(){this.flagUsername=!1,this.usernameMessage="至少使用六个字母、数字、下划线，且第一位是字母 "},usernameOnBlur:function(){var e=this;this.axios.post("api/users/userDetail",{username:this.form.username}).then(function(t){if(0==t.data.status)return e.form.username="",e.usernameMessage="用户名已经存在",e.flagUsername=!0,e.$refs.username.focus()})},passwordOnFocus:function(){return""==this.form.username?(this.flagUsername=!0,this.usernameMessage="用户名不能为空",this.$refs.username.focus()):/^[a-zA-z_]{1}[\w]{5,}$/.test(this.form.username)?void 0:(this.flagUsername=!0,this.usernameMessage="书写不符合标准",this.$refs.username.focus())},passwordOnInput:function(){this.flagPassword=!1,this.passwordMessage="至少使用六个字母、数字、下划线，且第一位是字母"},repasswordOnFocus:function(){return""==this.form.password?(this.flagPassword=!0,this.passwordMessage="密码不能为空",this.$refs.password.focus()):/^[a-zA-z_]{1}[\w]{5,}$/.test(this.form.password)?void 0:(this.flagPassword=!0,this.passwordMessage="书写不符合标准",this.$refs.password.focus())},repasswordOnInput:function(){this.flagRepassword=!1,this.repasswordMessage="请确认两次密码相同"},userMailOnFocus:function(){return""==this.form.repassword?(this.flagRepassword=!0,this.repasswordMessage="密码不能为空",this.$refs.repassword.focus()):this.form.password!==this.form.repassword?(this.flagRepassword=!0,this.repasswordMessage="两次密码必须一样",this.$refs.password.focus()):void 0},userMailOnInput:function(){this.flagUserMail=!1},userPhoneOnFocus:function(){return""==this.form.userMail?(this.flagUserMail=!0,this.userMailMessage="邮箱不能为空",this.$refs.userMail.focus()):/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(this.form.userMail)?void 0:(this.flagUserMail=!0,this.userMailMessage="邮箱格式不正确",this.$refs.userMail.focus())},userPhoneOnInput:function(){this.flagUserPhone=!1},userLogin:function(){this.$router.push({path:"/loginPage"})},userRegister:function(){var e=this;return""==this.form.userPhone?(this.flagUserPhone=!0,this.userPhoneMessage="手机号不能为空",this.$refs.userPhone.focus()):/^(13[0-9]|14[5-9]|15[012356789]|166|17[0-8]|18[0-9]|19[8-9])[0-9]{8}$/.test(this.form.userPhone)?!(this.flagUsername||this.flagPassword||this.flagRepassword||this.flagUserMail||this.flagUserPhone)&&void this.axios.post("api/users/register",this.form).then(function(t){1==t.data.status?e.errorMessage(t.data.message):e.login()}):(this.flagUserPhone=!0,this.userPhoneMessage="手机号格式不正确",this.$refs.userPhone.focus())},login:function(){var e=this;this.axios.post("api/users/login",{username:this.form.username,password:this.form.password}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):(localStorage.setItem("token",t.data.data.token),localStorage.setItem("username",t.data.data.user[0].username),localStorage.setItem("_id",t.data.data.user[0]._id),e.mes.successMessage("成功注册,两秒后跳转到主页"),setTimeout(function(){e.$router.push({path:"/"})},2e3))})}}},Ve={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",[s("h2",[e._v("请注册")]),e._v(" "),s("el-form",{attrs:{model:e.form}},[s("el-form-item",[s("el-input",{ref:"username",attrs:{placeholder:"请输入用户名"},on:{input:e.usernameOnInput,blur:e.usernameOnBlur},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[s("i",{staticClass:"el-input__icon  el-icon-user-solid",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[e.flagUsername?s("span",[e._v(e._s(e.usernameMessage))]):s("span",{staticClass:"flag_black"},[e._v(e._s(e.usernameMessage))])])],1),e._v(" "),s("el-form-item",[s("el-input",{ref:"password",attrs:{placeholder:"请输入密码","show-password":""},on:{focus:e.passwordOnFocus,input:e.passwordOnInput},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[s("i",{staticClass:"el-input__icon  el-icon-more",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[e.flagPassword?s("span",[e._v(e._s(e.passwordMessage))]):s("span",{staticClass:"flag_black"},[e._v(e._s(e.passwordMessage))])])],1),e._v(" "),s("el-form-item",[s("el-input",{ref:"repassword",attrs:{placeholder:"请再次输入密码","show-password":""},on:{focus:e.repasswordOnFocus,input:e.repasswordOnInput},model:{value:e.form.repassword,callback:function(t){e.$set(e.form,"repassword",t)},expression:"form.repassword"}},[s("i",{staticClass:"el-input__icon  el-icon-more",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[e.flagRepassword?s("span",[e._v(e._s(e.repasswordMessage))]):s("span",{staticClass:"flag_black"},[e._v(e._s(e.repasswordMessage))])])],1),e._v(" "),s("el-form-item",[s("el-input",{ref:"userMail",attrs:{placeholder:"请输入邮箱"},on:{focus:e.userMailOnFocus,input:e.userMailOnInput},model:{value:e.form.userMail,callback:function(t){e.$set(e.form,"userMail",t)},expression:"form.userMail"}},[s("i",{staticClass:"el-input__icon  el-icon-message",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[e.flagUserMail?s("span",[e._v(" "+e._s(e.userMailMessage))]):e._e()])],1),e._v(" "),s("el-form-item",[s("el-input",{ref:"userPhone",attrs:{placeholder:"请输入手机"},on:{focus:e.userPhoneOnFocus,input:e.userPhoneOnInput},model:{value:e.form.userPhone,callback:function(t){e.$set(e.form,"userPhone",t)},expression:"form.userPhone"}},[s("i",{staticClass:"el-input__icon  el-icon-mobile-phone",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[e.flagUserPhone?s("span",[e._v(" "+e._s(e.userPhoneMessage))]):e._e()])],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.userRegister}},[e._v("注册")]),e._v(" "),s("el-button",{on:{click:e.userLogin}},[e._v("登陆")])],1)],1)],1)],1)},staticRenderFns:[]};var Oe=s("VU/8")(Re,Ve,!1,function(e){s("13F4")},"data-v-ccbbce0e",null).exports,Ne={data:function(){return{form:{username:"",password:""},flagPassword:!1,flagUsername:!1}},methods:{usernameOninput:function(){this.flagUsername=!1},passwordOnfocus:function(){""==this.form.username&&(this.flagUsername=!0,this.$refs.username.focus())},passwordOninput:function(){this.flagPassword=!1},userLogin:function(e){var t=this;if(""==this.form.password&&(this.flagPassword=!0,this.$refs.password.focus()),this.flagUsername||this.flagPassword)return!1;this.axios.post("api/users/login",{username:this.form.username,password:this.form.password}).then(function(e){1==e.data.status?(t.mes.errorMessage(e.data.message),t.form.username="",t.form.password=""):(localStorage.setItem("token",e.data.data.token),localStorage.setItem("username",e.data.data.user[0].username),localStorage.setItem("_id",e.data.data.user[0]._id),t.mes.successMessage("成功注册,两秒后跳转到主页"),setTimeout(function(){t.$router.push({path:"/"})},2e3))})},userRegister:function(){this.$router.push({path:"/registerPage"})}}},je={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",[s("h2",[e._v("请登录")]),e._v(" "),s("el-form",{ref:"form",attrs:{model:e.form}},[s("el-form-item",[s("el-input",{ref:"username",attrs:{placeholder:"请输入用户名"},on:{input:e.usernameOninput},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[s("i",{staticClass:"el-input__icon  el-icon-user-solid",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.flagUsername,expression:"flagUsername"}]},[e._v(" 未输入用户名")])])],1),e._v(" "),s("el-form-item",[s("el-input",{ref:"password",attrs:{placeholder:"请输入密码","show-password":""},on:{focus:e.passwordOnfocus,input:e.passwordOninput},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[s("i",{staticClass:"el-input__icon el-icon-s-opportunity",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.flagPassword,expression:"flagPassword"}]},[e._v(" 未输入密码")])]),e._v(" "),s("router-link",{attrs:{to:"/repassword"}},[e._v("忘记密码")])],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.userLogin(e.form)}}},[e._v("登陆")]),e._v(" "),s("el-button",{on:{click:e.userRegister}},[e._v("注册")])],1)],1)],1)],1)},staticRenderFns:[]};var He=s("VU/8")(Ne,je,!1,function(e){s("WcrD")},"data-v-372afb16",null).exports,We={data:function(){return{form1:{userMail:"",userPhone:"",username:""},form2:{repassword:"",password:""},repasswordMessage:"",flagUsername:!1,flagUserMail:!1,flagUserPhone:!1,flagRepasswrd:!1,flagshowUserInfo:!0}},methods:{usernameOnInput:function(){this.flagUsername=!1},userMailOnFocus:function(){""==this.form1.username&&(this.flagUsername=!0,this.$refs.username.focus())},userMailOnInput:function(){this.flagUserMail=!1},userPhoneOnFocus:function(){""==this.form1.userMail&&(this.flagUserMail=!0,this.$refs.userMail.focus())},userPhoneOnInput:function(){this.flagUserPhone=!1},onRegister:function(){this.$router.push({path:"/registerPage"})},onLogin:function(){this.$router.push({path:"/loginPage"})},checkUser:function(){var e=this;if(""==this.form1.userPhone&&(this.flagUserPhone=!0,this.$refs.userPhone.focus()),this.flagUsername||this.flagUserMail||this.flagUserPhone)return!1;this.axios.post("api/users/findPassword",this.form1).then(function(t){1==t.data.status?(e.mes.errorMessage(t.data.message),e.form1.userMail="",e.form1.userPhone="",e.form1.username=""):(e.form2.password=t.data.data[0].password,e.flagshowUserInfo=!1)})},repasswordOnBlur:function(){if(this.form2.repassword==this.form2.password&&(this.$refs.repassword.focus(),this.repasswordMessage="新密码和原来密码相同",this.flagRepasswrd=!0),!/^[a-zA-z_]{1}[\w]{5,}$/.test(this.form2.repassword))return this.flagRepasswrd=!0,this.repasswordMessage="书写不符合标准",this.$refs.repassword.focus()},repasswordOnInput:function(){this.flagRepasswrd=!1},changeUserPassword:function(){var e=this;if(""==this.form2.repassword)return this.repasswordMessage="未输入密码",this.flagRepasswrd=!0,this.$refs.repassword.focus();if(this.flagRepasswrd)return!1;var t=l()({},this.form1,{repassword:this.form2.repassword});this.axios.post("api/users/findPassword",t).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):(e.mes.successMessage("更改成功,一秒后调转主页"),setTimeout(function(){e.$router.push({path:"/"})},1e3))})}}},Je={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",[s("h2",[e._v("找回密码")]),e._v(" "),e.flagshowUserInfo?s("el-form",{attrs:{model:e.form1}},[s("el-form-item",[s("el-input",{ref:"username",attrs:{placeholder:"请输入用户名"},on:{input:e.usernameOnInput},model:{value:e.form1.username,callback:function(t){e.$set(e.form1,"username",t)},expression:"form1.username"}},[s("i",{staticClass:"el-input__icon  el-icon-user-solid",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.flagUsername,expression:"flagUsername"}]},[e._v(" 未输入用户名")])])],1),e._v(" "),s("el-form-item",[s("el-input",{ref:"userMail",attrs:{placeholder:"请输入邮箱"},on:{focus:e.userMailOnFocus,input:e.userMailOnInput},model:{value:e.form1.userMail,callback:function(t){e.$set(e.form1,"userMail",t)},expression:"form1.userMail"}},[s("i",{staticClass:"el-input__icon  el-icon-message",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.flagUserMail,expression:"flagUserMail"}]},[e._v(" 未输入邮箱")])])],1),e._v(" "),s("el-form-item",[s("el-input",{ref:"userPhone",attrs:{placeholder:"请输入手机"},on:{focus:e.userPhoneOnFocus,input:e.userPhoneOnInput},model:{value:e.form1.userPhone,callback:function(t){e.$set(e.form1,"userPhone",t)},expression:"form1.userPhone"}},[s("i",{staticClass:"el-input__icon  el-icon-mobile-phone",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),s("div",{staticClass:"flagError"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.flagUserPhone,expression:"flagUserPhone"}]},[e._v(" 未输入手机号")])])],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.checkUser}},[e._v("找回密码")]),e._v(" "),s("el-button",{on:{click:e.onRegister}},[e._v("注册")]),e._v(" "),s("el-button",{on:{click:e.onLogin}},[e._v("登陆")])],1)],1):s("el-form",{attrs:{model:e.form2}},[s("el-form-item",[s("el-input",{ref:"repassword",attrs:{placeholder:"请输入新密码"},on:{blur:e.repasswordOnBlur,input:e.repasswordOnInput},model:{value:e.form2.repassword,callback:function(t){e.$set(e.form2,"repassword",t)},expression:"form2.repassword"}}),e._v(" "),s("div",{staticClass:"flagError"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.flagRepasswrd,expression:"flagRepasswrd"}]},[e._v(e._s(e.repasswordMessage))])])],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.changeUserPassword}},[e._v("修改密码")])],1)],1)],1)],1)},staticRenderFns:[]};var qe=s("VU/8")(We,Je,!1,function(e){s("PgMh")},"data-v-323cb551",null).exports,Ye={data:function(){return{user_id:"",falg:"",showRePassword:!1,password:"",repassword:"",list:"",userfllow:[],userLabel:[],flagUserLabel:!1,userLabelValue:""}},created:function(){this.user_id=this.$route.params.id,this.getdata()},beforeRouteUpdate:function(e,t,s){this.user_id=e.params.id,this.getdata(),s()},methods:{getdata:function(){var e=this;this.userfllow=[],this.user_id==localStorage._id&&(this.falg=!0),this.user_id!==localStorage._id&&(this.falg=!1),this.user_id&&this.axios.post("api/showUser",{user_id:this.user_id}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):(e.userLabel=t.data.data[0].userLabel.split("/"),e.list=t.data.data[0],t.data.data[0].userFllow.split(",").map(function(t){e.axios.post("api/users/userDetail",{user_id:t}).then(function(t){var s=t.data.data[0];e.userfllow.push(s)})}))})},onUserMotto:function(){this.$refs.userMotto.contentEditable=!0,this.$refs.userMotto.focus()},blurUserMotto:function(){var e=this;this.$refs.userMotto.contentEditable=!1;var t=this.$refs.userMotto.innerText;this.axios.post("api/users/updateUser",{user_id:localStorage._id,userMotto:t,flay:5}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):e.mes.successMessage("已经更新座右铭")})},handleAvatarSuccess:function(e,t,s){var a=this,i=e.data;this.axios.post("api/users/updateUser",{user_id:localStorage._id,flay:6,userImg:i}).then(function(e){0==e.data.status&&a.getdata()})},beforeAvatarUpload:function(e){var t=this;return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("user")?(this.mes.errorMessage("上传的头像图片命名必须包含user"),!1):""==this.list.userImg?(this.mes.errorMessage("图片为空"),!1):void(-1==this.list.userImg.indexOf("default")&&this.axios.post("api/upload/userDel",{username:this.list.userImg}).then(function(e){0==e.data.status||t.mes.errorMessage(e.data.message)})):(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},onUserCity:function(){this.$refs.userCity.contentEditable=!0,this.$refs.userCity.focus()},blurUserCity:function(){var e=this,t=this.$refs.userCity.innerText;this.axios.post("api/users/updateUser",{user_id:localStorage._id,userCity:t,flay:2}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):e.mes.successMessage("已经更新城市")}),this.$refs.userCity.contentEditable=!1},userLabelClose:function(e){if(this.userLabel.splice(this.userLabel.indexOf(e),1),0==this.userLabel)var t="";else t=this.userLabel.join("/");this.axios.post("api/users/updateUser",{user_id:localStorage._id,flay:3,userLabel:t}).then(function(e){})},showUserLabel:function(){var e=this;this.flagUserLabel=!0,this.$nextTick(function(t){e.$refs.userLabelInput.$refs.input.focus()})},userLabelAdd:function(){var e=this;this.userLabelValue&&this.userLabel.push(this.userLabelValue),this.flagUserLabel=!1,this.userLabelValue="";var t=this.userLabel.join("/");this.axios.post("api/users/updateUser",{user_id:localStorage._id,flay:3,userLabel:t}).then(function(t){0==t.data.status&&e.mes.successMessage("已添加标签")})},sendEmail:function(){localStorage._id?this.$router.push({path:"/sendEmail"}):(this.mes.errorMessage("未登陆，两秒后调转登陆界面"),this.$router.push({path:"/loginPage"}))},addFllow:function(){var e=this;localStorage._id?this.axios.post("api/users/userDetail",{user_id:localStorage._id}).then(function(t){if(1==t.data.status)e.mes.errorMessage(t.data.message);else if(t.data.data[0].userFllow.indexOf(e.user_id)>=0)e.mes.promptMessage("已经关注过，请不要重复操作");else{var s=t.data.data[0].userFllow+","+e.user_id;e.axios.post("api/users/updateUser",{user_id:localStorage._id,userFllow:s,flay:0}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):e.mes.successMessage("已经关注")})}}):(this.mes.promptMessage("未登陆，两秒后调转登陆界面"),setTimeout(function(){return e.$router.push({path:"/loginPage"})},2e3))},showeUserPassword:function(){this.showRePassword=!0},changeUserPassword:function(){var e=this;if(""==this.password)return this.$refs.password.focus(),this.mes.errorMessage("请输入密码");if(""==this.repassword)return this.$refs.repassword.focus(),this.mes.errorMessage("请输入新设密码");var t={token:localStorage.token,repassword:this.repassword,user_id:this.user_id,password:this.password};this.axios.post("api/users/findPassword",t).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):(e.mes.successMessage(t.data.message),e.showRePassword=!e.showRePassword,e.password="",e.repassword="")})},onUserDescription:function(){this.$refs.userDescription.contentEditable=!0,this.$refs.userDescription.focus()},blurUserDescription:function(){var e=this;this.$refs.userDescription.contentEditable=!1;var t=this.$refs.userDescription.innerText;this.axios.post("api/users/updateUser",{user_id:localStorage._id,flay:4,userDescription:t}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):e.mes.successMessage("已经更改描述")})}},components:{MovieIndexHeader:u,CommonFooter:d,UserMessage:w}},Ke={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",[s("movie-index-header")],1),e._v(" "),s("div",{staticClass:"userMessage"},[s("user-message")],1),e._v(" "),s("div",{staticClass:"contentMain"},[s("el-row",{attrs:{gutter:60}},[s("el-col",{staticClass:"main",attrs:{span:16}},[s("div",{staticClass:"user"},[s("img",{attrs:{src:e.list.userImg}}),e._v(" "),s("div",[s("h3",[e._v(e._s(e.list.username))]),e._v(" "),s("div",{staticClass:"userMotto"},[s("span",{ref:"userMotto",on:{blur:e.blurUserMotto}},[e._v(" "+e._s(e.list.userMotto))]),e._v(" "),e.falg?s("i",{staticClass:"el-icon-edit icon_edit",on:{click:e.onUserMotto}}):e._e()])])]),e._v(" "),s("div",{staticClass:"user_nav"},[s("router-link",{attrs:{to:{path:"/userInfo/"+e.user_id}}},[e._v("个人主页")]),e._v(" "),s("router-link",{attrs:{to:{path:"/userInfo/"+e.user_id+"/diary"}}},[e._v("日记")]),e._v(" "),s("router-link",{attrs:{to:{path:"/userInfo/"+e.user_id+"/article"}}},[e._v("文章")]),e._v(" "),s("router-link",{attrs:{to:{path:"/userInfo/"+e.user_id+"/square"}}},[e._v("广场")])],1),e._v(" "),s("div",{staticClass:"user_content"},[s("router-view")],1)]),e._v(" "),s("el-col",{staticClass:"side",attrs:{span:8}},[s("div",{staticClass:"user_detail"},[s("div",[s("div",{staticStyle:{overflow:"hidden","margin-bottom":"10px"}},[s("el-form",{staticClass:"user_img"},[e.falg?s("el-form-item",[s("el-upload",{staticClass:"avatar-uploader",attrs:{name:"file",action:"api/upload/user","on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.list.userImg?s("img",{staticClass:"avatar",attrs:{src:e.list.userImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),s("span",[e._v("点击更换")])],1):s("el-form-item",[s("img",{staticClass:"avatar",attrs:{src:e.list.userImg}})])],1),e._v(" "),s("div",{staticClass:"user_des"},[s("p",[e._v("常居:\n\t\t\t\t\t\t\t\t\t"),s("span",{ref:"userCity",on:{blur:e.blurUserCity}},[e._v(" "+e._s(e.list.userCity))]),e._v(" "),e.falg?s("i",{staticClass:"el-icon-edit icon_edit",on:{click:e.onUserCity}}):e._e()]),e._v(" "),s("p",[e._v("注册:"),s("span",[e._v(e._s(e._f("forMatTime")(e.list.userJoinTime)))])]),e._v(" "),s("p",[e._v("标签:\n\t\t\t\t\t\t\t\t\t"),s("span",[void 0==e.userLabel||e.userLabel.length<=0?e._e():s("span",e._l(e.userLabel,function(t,a){return s("el-tag",{key:a,attrs:{closable:e.falg,size:"mini"},on:{close:function(s){return e.userLabelClose(t)}}},[e._v(e._s(t))])}),1),e._v(" "),e.falg?s("div",{staticStyle:{display:"inline"}},[e.flagUserLabel?s("el-input",{ref:"userLabelInput",staticStyle:{width:"90px"},attrs:{size:"mini",type:"text"},on:{blur:e.userLabelAdd},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.userLabelAdd(t)}},model:{value:e.userLabelValue,callback:function(t){e.userLabelValue=t},expression:"userLabelValue"}}):s("el-tag",{attrs:{size:"mini"},on:{click:e.showUserLabel}},[e._v("+添加标签\n\t\t\t\t\t\t\t\t\t\t\t")])],1):e._e()])])])],1),e._v(" "),s("p",{staticClass:"send_email"},[s("button",{on:{click:e.sendEmail}},[e._v("发送站内信")]),e._v(" "),e.falg?s("button",{directives:[{name:"show",rawName:"v-show",value:!e.showRePassword,expression:"!showRePassword"}],on:{click:e.showeUserPassword}},[e._v(" 修改密码 ")]):s("button",{on:{click:e.addFllow}},[e._v("添加关注")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showRePassword,expression:"showRePassword"}],staticClass:"send_password"},[s("el-form",{attrs:{"label-width":"120px",size:"mini"}},[s("el-form-item",{attrs:{label:"输入旧密码"}},[s("el-input",{ref:"password",attrs:{type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"输入新密码"}},[s("el-input",{ref:"repassword",attrs:{type:"password"},model:{value:e.repassword,callback:function(t){e.repassword=t},expression:"repassword"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.changeUserPassword}},[e._v("修改密码")])],1)],1)],1),e._v(" "),s("p"),e._v(" "),s("div",{staticClass:"user_description"},[s("span",{ref:"userDescription",on:{blur:e.blurUserDescription}},[e._v(" "+e._s(e.list.userDescription))]),e._v(" "),e.falg?s("i",{staticClass:"el-icon-edit icon_edit",on:{click:e.onUserDescription}}):e._e()])])]),e._v(" "),s("div",{staticClass:"user_fllow"},[s("h3",[e._v("我关注的人")]),e._v(" "),void 0==e.userfllow||e.userfllow.length<=0?s("div",{staticClass:"unfllow"},[e._v("\n\t\t\t\t\t\t您暂未关注任何人\n\t\t\t\t\t")]):s("div",{staticClass:"fllow"},e._l(e.userfllow,function(t,a){return s("div",{key:a},[s("img",{attrs:{src:t.userImg}}),e._v(" "),s("p",[s("router-link",{attrs:{to:{path:"/userInfo/"+t._id}}},[e._v("\n\t\t\t\t\t\t\t\t\t"+e._s(t.username)+"\n\t\t\t\t\t\t\t\t")])],1)])}),0)])])],1)],1),e._v(" "),s("div",[s("common-footer")],1)])},staticRenderFns:[]};var Ge=s("VU/8")(Ye,Ke,!1,function(e){s("Qki6"),s("lH/p")},"data-v-7872ee8b",null).exports,Xe={data:function(){return{user:"",list:"",user_id:""}},props:["_id"],created:function(){this.user_id=this.$route.params.id,this.getData()},beforeRouteUpdate:function(e,t,s){this.user_id=e.params.id,this.getData(),s()},watch:{_id:function(e,t){this.user_id=e,this.getData()}},methods:{getData:function(){var e=this;this.axios.post("/api/admin/article",{user_id:this.user_id}).then(function(t){e.list=t.data.data})}},components:{NewsList:p}},Ze={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"article"},[void 0==this.list||this.list.length<=0?t("div",{staticClass:"art"},[this._v("\n\t\t暂无文章\n\t")]):t("div",[t("news-list",{attrs:{list:this.list}})],1)])},staticRenderFns:[]};var Qe=s("VU/8")(Xe,Ze,!1,function(e){s("lhke")},"data-v-29e79b52",null).exports,et={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"diary"},[t("div",[this._v("暂无日记内容")])])}]};var tt=s("VU/8")({data:function(){return{user:"",user_id:""}},created:function(){this.user_id=this.$route.params.id,this.getData()},methods:{getData:function(){var e=this;this.axios.post("api/showUser",{user_id:this.user_id}).then(function(t){e.user=t.data.data[0]})}}},et,!1,function(e){s("aloF")},"data-v-509ec57c",null).exports,st={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"square"},[t("div",[this._v("暂无广场信息")])])}]};var at=s("VU/8")({data:function(){return{user_id:"",user:""}},created:function(){this.user_id=this.$route.params.id,this.getData()},methods:{getData:function(){var e=this;this.axios.post("api/showUser",{user_id:this.user_id}).then(function(t){e.user=t.data.data[0]})}}},st,!1,function(e){s("AU0r")},"data-v-7582f2ea",null).exports,it={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messagelist"},[s("img",{attrs:{src:e.item.userImg}}),e._v(" "),s("div",{staticClass:"message"},[s("p",[s("span",[s("router-link",{attrs:{to:{path:"/userInfo/"+e.item.fromUser}}},[e._v(e._s(e.item.username)+":")])],1),e._v(" "),s("span",[e._v(e._s(e.item.context))]),e._v(" "),s("span",[e._v(e._s(e._f("forMatTime")(e.item.sendTime)))])])])])},staticRenderFns:[]};var nt={name:"usermessage",data:function(){return{user_id:"",flag:!0,context:"",messagelist:[]}},props:["_id"],created:function(){this.user_id=this.$route.params.id,this.getData()},watch:{_id:function(e,t){this.user_id=e,this.getData()}},beforeRouteUpdate:function(){this.user_id=to.params.id,this.getData(),next()},methods:{getData:function(){var e=this;this.messagelist=[],localStorage._id&&localStorage._id==this.user_id&&(this.flag=!1),this.axios.post("api/users/showMessage",{toUser:this.user_id}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):[].concat(i()(t.data.data)).forEach(function(t){e.axios.post("api/users/userDetail",{user_id:t.fromUser}).then(function(s){t.userImg=s.data.data[0].userImg,t.username=s.data.data[0].username,e.messagelist.push(t)})})})},sendMessage:function(){var e=this;if(""==this.context)return this.mes.errorMessage("留言框不能为空"),!1;if(localStorage._id){var t={context:this.context,toUser:this.user_id,token:localStorage.token,user_id:localStorage._id};this.axios.post("api/users/sendMessage",t).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):(e.context="",e.mes.successMessage("留言成功"),e.getData())})}else setTimeout(function(){e.$router.push({path:"/loginPage"})},2e3)}},components:{MessageList:s("VU/8")({name:"messagelist",data:function(){return{}},props:["item"],created:function(){},methods:{}},it,!1,function(e){s("gOxp")},"data-v-7e2270c0",null).exports}},rt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message"},[s("div",{staticClass:"showMessage"},[void 0==e.messagelist||e.messagelist.length<=0?s("div",[e._v("目前暂无留言")]):s("div",e._l(e.messagelist,function(e,t){return s("message-list",{key:t,attrs:{item:e}})}),1)]),e._v(" "),e.flag?s("div",{staticClass:"sendMessage"},[s("h5",[e._v("请留言")]),e._v(" "),s("el-input",{attrs:{type:"textarea"},model:{value:e.context,callback:function(t){e.context=t},expression:"context"}}),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.sendMessage}},[e._v("留言")])],1):e._e()])},staticRenderFns:[]};var ot={data:function(){return{activeName:"4",user_id:""}},created:function(){this.user_id=this.$route.params.id},beforeRouteUpdate:function(e,t,s){this.user_id=e.params.id,s()},components:{UserArticle:Qe,UserDiary:tt,UserSquare:at,UserMessage:s("VU/8")(nt,rt,!1,function(e){s("+lKd")},"data-v-aec72d5c",null).exports}},lt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"userprofile"},[s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{attrs:{title:"文章",name:"1"}},[s("user-article",{attrs:{_id:e.user_id}})],1),e._v(" "),s("el-collapse-item",{attrs:{title:"日记",name:"2"}},[s("user-diary",{attrs:{_id:e.user_id}})],1),e._v(" "),s("el-collapse-item",{attrs:{title:"广场",name:"3"}},[s("user-square",{attrs:{_id:e.user_id}})],1),e._v(" "),s("el-collapse-item",{attrs:{title:"留言板",name:"4"}},[s("user-message",{attrs:{_id:e.user_id}})],1)],1)],1)},staticRenderFns:[]};var ct=s("VU/8")(ot,lt,!1,function(e){s("Sobn"),s("NxzW")},"data-v-35e54dea",null).exports,ut={name:"sendEmail",data:function(){return{detail:""}},created:function(){},components:{MovieIndexHeader:u,CommonFooter:d,UserMessage:w}},mt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",[s("movie-index-header")],1),e._v(" "),s("div",{staticClass:"userMessage"},[s("user-message")],1),e._v(" "),s("div",{staticClass:"contentMain"},[s("el-row",{attrs:{gutter:60}},[s("el-col",{staticClass:"main",attrs:{span:16}},[s("router-view")],1),e._v(" "),s("el-col",{staticClass:"sider",attrs:{span:8}},[s("div",{staticClass:"nav"},[s("span",[e._v(">"),s("router-link",{attrs:{to:"/sendEmail"}},[e._v("收件箱")])],1),e._v(" "),s("span",[e._v(">"),s("router-link",{attrs:{to:"/sendEmail/sendtalkbox"}},[e._v("发邮件")])],1),e._v(" "),s("span",[e._v(">"),s("router-link",{attrs:{to:"/sendEmail/followlist"}},[e._v("关注人列表")])],1),e._v(" "),s("span",[e._v(">"),s("router-link",{attrs:{to:"/sendEmail/blacklist"}},[e._v("管理黑名单")])],1),e._v(" "),s("span",[e._v(">"),s("router-link",{attrs:{to:"/sendEmail/junkemail"}},[e._v("垃圾邮件")])],1)])])],1)],1),e._v(" "),s("div",[s("common-footer")],1)])},staticRenderFns:[]};var dt=s("VU/8")(ut,mt,!1,function(e){s("Kolr")},"data-v-1424b831",null).exports,ft={data:function(){return{user_id:"",user:""}},props:["item"],created:function(){this.user_id=localStorage._id==this.item.toUser?this.item.fromUser:this.item.toUser,this.getData()},methods:{delEmail:function(){this.$emit("listenDelEmail",this.item)},addBlack:function(){var e=this;this.axios.post("api/users/userDetail",{user_id:localStorage._id}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):t.data.data[0].userBlack.indexOf(e.user_id)>=0?e.mes.errorMessage("已经加入黑名单，不可重复操作"):e.$confirm("将加入黑名单, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=t.data.data[0].userBlack+","+e.user_id;e.axios.post("api/users/updateUser",{user_id:localStorage._id,userBlack:s,flay:1}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):e.mes.errorMessage("加入黑名单成功，但是邮件需要手动删除")})}).catch(function(){e.mes.promptMessage("已取消加入黑名单")})})},getData:function(){var e=this;this.axios.post("/api/showUser",{user_id:this.user_id}).then(function(t){return e.user=t.data.data[0]})},btnEmail:function(e){console.log("11"),this.$alert(e,"邮件内容",{confirmButtonText:"确定"})},btnSay:function(){this.$alert("暂未开通此功能","内容",{confirmButtonText:"确定"})}}},pt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message"},[s("li",[s("div",{staticClass:"left"},[s("img",{attrs:{src:e.user.userImg}}),e._v(" "),s("p",[s("span",[s("router-link",{attrs:{to:{path:"/userInfo/"+e.user._id}}},[e._v(e._s(e.user.username))])],1),e._v(" "),s("router-link",{attrs:{to:""},on:{click:e.btnSay}},[e._v("[打招呼]")])],1)]),e._v(" "),s("div",{staticClass:"title"},[s("p",{on:{click:function(t){return e.btnEmail(e.item.context)}}},[s("router-link",{attrs:{to:""}},[e._v("\n\t\t\t\t"+e._s(e.item.title)+"\n\t\t\t\t")])],1)]),e._v(" "),s("div",{staticClass:"right"},[s("p",[e._v(e._s(e._f("forMatTime")(e.item.sendTime)))]),e._v(" "),s("p",{staticClass:"btn"},[s("span",{on:{click:e.addBlack}},[e._v("加入黑名单")]),e._v(" "),s("span",{on:{click:e.delEmail}},[e._v("删除")])])])])])},staticRenderFns:[]};var vt={data:function(){return{receive_items:[],send_items:[],value:"both",options:[{value:"both",label:"全部邮件"},{value:"outbox",label:"发件箱"},{value:"inbox",label:"收件箱"}],email_in:!0,email_out:!0}},created:function(){this.getData()},methods:{getData:function(){var e=this,t=localStorage._id,s={token:localStorage.token,user_id:localStorage._id,receive:0},a={token:localStorage.token,user_id:localStorage._id,receive:1};t&&(this.axios.post("api/users/showEmail",s).then(function(t){0==t.data.status?e.send_items=t.data.data:e.mes.errorMessage(t.data.message)}),this.axios.post("api/users/showEmail",a).then(function(t){0==t.data.status?e.receive_items=t.data.data:e.mes.errorMessage(t.data.message)}))},selectValue:function(){"both"==this.value&&(this.email_in=!0,this.email_out=!0),"inbox"==this.value&&(this.email_in=!0,this.email_out=!1),"outbox"==this.value&&(this.email_out=!0,this.email_in=!1)},delEmail:function(e){var t=this;this.$confirm("将删除这个邮件, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=t.receive_items.indexOf(e),a=t.send_items.indexOf(e);-1!==s&&t.axios.post("api/users/delEmail",{mail_id:e._id}).then(function(e){0==e.data.status?(t.receive_items.splice(s,1),t.mes.successMessage("删除成功!")):t.mes.errorMessage(e.data.message)}),-1!==a&&t.axios.post("api/users/delEmail",{mail_id:e._id}).then(function(e){0==e.data.status?(t.send_items.splice(a,1),t.mes.successMessage("删除成功!")):t.mes.errorMessage(e.data.message)})}).catch(function(){t.mes.promptMessage("已取消删除")})}},components:{EmailList:s("VU/8")(ft,pt,!1,function(e){s("xV6C")},"data-v-da421104",null).exports}},ht={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"email"},[s("h2",[e._v("我的站内信")]),e._v(" "),s("div",{staticClass:"email-nav"},[s("p",[e._v("邮件(未读)")]),e._v(" "),s("p",[s("span",[e._v("\n\t\t\t\t筛选:\n\t\t\t\t"),s("select",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.value=t.target.multiple?s:s[0]},e.selectValue]}},e._l(e.options,function(t){return s("option",{key:t.value,domProps:{value:t.value}},[e._v(e._s(t.label))])}),0)])])]),e._v(" "),e.email_in?s("div",{staticClass:"email-in"},[s("h3",[e._v("收件箱")]),e._v(" "),e._l(e.receive_items,function(t,a){return s("email-list",{key:a,attrs:{item:t},on:{listenDelEmail:e.delEmail}})})],2):e._e(),e._v(" "),e.email_out?s("div",{staticClass:"email-out"},[s("h3",[e._v("发件箱")]),e._v(" "),e._l(e.send_items,function(t,a){return s("email-list",{key:a,attrs:{item:t},on:{listenDelEmail:e.delEmail}})})],2):e._e()])},staticRenderFns:[]};var gt=s("VU/8")(vt,ht,!1,function(e){s("BNnv")},"data-v-382b4bea",null).exports,_t={data:function(){return{form:{username:"",title:"",context:""},toUser:""}},methods:{titleFocus:function(){if(""==this.form.username)return this.mes.errorMessage("用户名不能为空"),this.$refs.username.focus()},contextFocus:function(){if(""==this.form.title)return this.mes.errorMessage("标题不能为空"),this.$refs.title.focus()},usernameBlur:function(e){var t=this;if(""!==this.form.username){if(this.form.username==localStorage.username)return this.mes.errorMessage("不能给自己发站内信"),this.form.username="",this.$refs.username.focus();this.axios.post("api/users/userDetail",{username:this.form.username}).then(function(e){if(1==e.data.status)return t.mes.errorMessage(e.data.message),t.form.username="",t.toUser="",t.$refs.username.focus();if(e.data.data[0].userBlack.indexOf(localStorage._id)>=0)return t.mes.errorMessage("您在对方的黑名单中，不能发送站内信"),t.form.username="",t.toUser="",t.$refs.username.focus();t.toUser=e.data.data[0]._id;var s=localStorage._id;t.axios.post("api/users/userDetail",{user_id:s}).then(function(e){if(1==e.data.status)t.mes.errorMessage(e.data.message);else if(-1!==e.data.data[0].userBlack.indexOf(t.toUser))return t.mes.errorMessage("收件人在您的黑名单里，不能发送，请先移出"),t.form.username="",t.toUser="",t.$refs.username.focus()})})}},send_mail:function(){var e=this;if(""==this.form.context)return this.mes.errorMessage("内容不能为空"),this.$refs.context.focus();var t={title:this.form.title,context:this.form.context,toUser:this.toUser,token:localStorage.token,user_id:localStorage._id};this.axios.post("api/users/sendEmail",t).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):(e.mes.promptMessage("发送成功，2秒后跳转到收件箱"),setTimeout(function(){e.$router.push({path:"/sendEmail"})},2e3))})}}},bt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sendtalkbox"},[s("h2",[e._v("发邮件")]),e._v(" "),s("div",[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"60px"}},[s("el-form-item",{attrs:{label:"收件人"}},[s("el-input",{ref:"username",on:{blur:e.usernameBlur},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"标题"}},[s("el-input",{ref:"title",on:{focus:e.titleFocus},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"内容"}},[s("el-input",{ref:"context",attrs:{type:"textarea",maxlength:"500"},on:{focus:e.contextFocus},model:{value:e.form.context,callback:function(t){e.$set(e.form,"context",t)},expression:"form.context"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.send_mail}},[e._v("提交")]),e._v(" "),s("el-button",[e._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var xt=s("VU/8")(_t,bt,!1,function(e){s("f0KU")},"data-v-2693a9cc",null).exports,wt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fllowuser"},[s("div",{staticClass:"btn"},[s("button",{on:{click:e.delFllow}},[e._v("取消关注")])]),e._v(" "),s("div",{staticClass:"user"},[s("img",{attrs:{src:e.user.userImg}}),e._v(" "),s("p",[s("span",[s("router-link",{attrs:{to:{path:"/userInfo/"+e.user._id}}},[e._v(e._s(e.user.username))])],1),e._v(" "),s("span",[e._v(e._s(e.user.userCity))])]),e._v(" "),s("p",[e._v(e._s(e.user.userMotto))])])])},staticRenderFns:[]};var Ct={name:"fllowlist",data:function(){return{user_list:[]}},created:function(){this.getData()},methods:{getData:function(){var e=this,t=localStorage._id;t?this.axios.post("api/users/userDetail",{user_id:t}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):t.data.data[0].userFllow&&(e.user_list=t.data.data[0].userFllow.split(","))}):(this.mes.promptMessage("没有登陆，2秒后返回登陆界面"),setTimeout(function(){return e.$router.push({path:"/loginPage"})},2e3))},delFllow:function(e){var t=this;this.$confirm("将取消关注, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=localStorage._id;if(s){var a=t.user_list.indexOf(e);t.user_list.splice(a,1);var i=t.user_list.join(",");t.axios.post("api/users/updateUser",{user_id:s,userFllow:i,flay:0}).then(function(e){1==e.data.status?t.mes.errorMessage(e.data.message):t.mes.successMessage("已取消关注")})}else t.mes.promptMessage("没有登陆，2秒后返回登陆界面"),setTimeout(function(){return t.$router.push({path:"/loginPage"})},2e3)}).catch(function(){t.mes.promptMessage("已取消删除")})}},components:{FllowUserList:s("VU/8")({name:"fllowuser",data:function(){return{user:""}},props:["user_id"],created:function(){this.getData()},methods:{getData:function(){var e=this;this.axios.post("api/users/userDetail",{user_id:this.user_id}).then(function(t){1==t.data.status||(e.user=t.data.data[0])})},delFllow:function(){this.$emit("listenDelFllow",this.user_id)}}},wt,!1,function(e){s("xvVk")},"data-v-4fa0ba98",null).exports}},kt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fllowlist"},[s("h2",[e._v("我关注的人")]),e._v(" "),void 0==e.user_list||e.user_list.length<=0?s("div",{staticClass:"side"},[s("p",[e._v("你还没关注任何成员")])]):s("div",{staticClass:"main"},e._l(e.user_list,function(t,a){return s("div",{key:a},[s("fllow-user-list",{attrs:{user_id:t},on:{listenDelFllow:e.delFllow}})],1)}),0)])},staticRenderFns:[]};var yt=s("VU/8")(Ct,kt,!1,function(e){s("yeBs")},"data-v-72f55f33",null).exports,Mt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"blackuser"},[s("div",{staticClass:"btn"},[s("button",{on:{click:e.delBlack}},[e._v("移出黑名单")])]),e._v(" "),s("div",{staticClass:"user"},[s("img",{attrs:{src:e.user.userImg}}),e._v(" "),s("p",[s("span",[s("router-link",{attrs:{to:{path:"/userInfo/"+e.user._id}}},[e._v(e._s(e.user.username))])],1),e._v(" "),s("span",[e._v(e._s(e.user.userCity))])]),e._v(" "),s("p",[e._v(e._s(e.user.userMotto))])])])},staticRenderFns:[]};var St={name:"blacklist",data:function(){return{user_list:[]}},created:function(){this.getData()},methods:{getData:function(){var e=this,t=localStorage._id;t?this.axios.post("api/users/userDetail",{user_id:t}).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):t.data.data[0].userBlack&&(e.user_list=t.data.data[0].userBlack.split(","))}):(this.mes.promptMessage("没有登陆，2秒后返回登陆界面"),setTimeout(function(){return e.$router.push({path:"/loginPage"})},2e3))},delBlack:function(e){var t=this;this.$confirm("将移出黑名单, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=localStorage._id;if(s){var a=t.user_list.indexOf(e);t.user_list.splice(a,1);var i=t.user_list.join(",");t.axios.post("api/users/updateUser",{user_id:s,userBlack:i,flay:1}).then(function(e){1==e.data.status?t.mes.errorMessage(e.data.message):t.mes.successMessage("已移出黑明单")})}else t.mes.promptMessage("没有登陆，2秒后返回登陆界面"),setTimeout(function(){return t.$router.push({path:"/loginPage"})},2e3)}).catch(function(){t.mes.promptMessage("已取消")})}},components:{BlackUserList:s("VU/8")({name:"blackuser",data:function(){return{user:""}},props:["user_id"],created:function(){this.getData()},methods:{getData:function(){var e=this;this.user_id&&this.axios.post("api/users/userDetail",{user_id:this.user_id}).then(function(t){1==t.data.status||(e.user=t.data.data[0])})},delBlack:function(){this.$emit("listenDelBlack",this.user_id)}}},Mt,!1,function(e){s("GN1v")},"data-v-29667748",null).exports}},Dt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"blacklist"},[s("h2",[e._v("黑名单管理")]),e._v(" "),void 0==e.user_list||e.user_list.length<=0?s("div",{staticClass:"sider"},[s("p",[e._v("你还没将任何成员列入黑名单")])]):s("div",{staticClass:"main"},e._l(e.user_list,function(t,a){return s("div",{key:a},[s("black-user-list",{attrs:{user_id:t},on:{listenDelBlack:e.delBlack}})],1)}),0)])},staticRenderFns:[]};var $t=s("VU/8")(St,Dt,!1,function(e){s("sz3g")},"data-v-b4d1b562",null).exports,Ut={data:function(){return{user_id:"",flag:!0,form:{userImg:"",userMail:"",username:"",userPhone:"",userCity:"",userMotto:"",userJoinTime:"",userAdmin:"",userStop:"",userDescription:"",userLabel:""},password:"",repassword:""}},created:function(){this.user_id=this.$route.params.id,this.getData()},methods:{getData:function(){var e=this;this.axios.post("api/users/userDetail",{user_id:this.user_id}).then(function(t){e.form=t.data.data[0],1==e.form.userAdmin?e.form.userAdmin="true":e.form.userAdmin="false",1==e.form.userStop?e.form.userStop="true":e.form.userStop="false"})},handleAvatarSuccess:function(e,t,s){var a=this,i=e.data;this.axios.post("api/users/updateUser",{user_id:localStorage._id,flay:6,userImg:i}).then(function(e){0==e.data.status&&a.getData()})},beforeAvatarUpload:function(e){var t=this;return"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type?(this.mes.errorMessage("请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片!"),!1):e.size/1024/1024<2?-1==e.name.indexOf("user")?(this.mes.errorMessage("上传的头像图片命名必须包含user"),!1):""==this.form.userImg?(this.mes.errorMessage("图片为空"),!1):void(-1==this.form.userImg.indexOf("default")&&this.axios.post("/api/upload/userDel",{username:this.form.userImg}).then(function(e){0==e.data.status||t.mes.errorMessage(e.data.message)})):(this.mes.errorMessage("上传头像图片大小不能超过 2MB!"),!1)},onSubmit:function(){var e=this;if(""==this.form.username||""==this.form.userPhone)return this.mes.promptMessage("用户名和邮箱不能为空");var t=this.form;this.axios.post("api/users/updateUser",t).then(function(t){0==t.data.status?(e.mes.successMessage("更新成功"),e.getData()):e.mes.errorMessage(t.data.message)})},rePassword:function(){this.flag=!1},changeUserPassword:function(){var e=this;if(""==this.password)return this.errorMessage("新密码不能为空");if(""==this.repassword)return this.errorMessage("原密码不能为空");var t={token:localStorage.token,repassword:this.repassword,user_id:this.user_id,password:this.password};this.axios.post("/api/users/findPassword",t).then(function(t){1==t.data.status?e.mes.errorMessage(t.data.message):(e.mes.successMessage(t.data.message),e.flag=!0)})}},components:{MovieIndexHeader:u,CommonFooter:d,UserMessage:w}},It={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",[s("movie-index-header")],1),e._v(" "),s("div",{staticClass:"userMessage"},[s("user-message")],1),e._v(" "),s("div",{staticClass:"contentMain"},[s("el-row",{attrs:{gutter:60}},[s("el-col",{staticClass:"main",attrs:{span:16}},[e.flag?s("div",{staticClass:"form"},[s("h2",[e._v("账号管理")]),e._v(" "),s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"85px",size:"mini"}},[s("el-form-item",{attrs:{label:"头像"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:"api/upload/user","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.userImg?s("img",{staticClass:"avatar",attrs:{src:e.form.userImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),s("span",[e._v("点击更换头像")])],1),e._v(" "),s("el-form-item",{attrs:{label:"邮箱"}},[s("el-input",{attrs:{disabled:""},model:{value:e.form.userMail,callback:function(t){e.$set(e.form,"userMail",t)},expression:"form.userMail"}}),e._v(" "),s("span",[e._v("登陆邮箱不能进行更改")])],1),e._v(" "),s("el-form-item",{attrs:{label:"用户名"}},[s("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),e._v(" "),s("span",[e._v("限制在6个字符以上")])],1),e._v(" "),s("el-form-item",{attrs:{label:"手机"}},[s("el-input",{model:{value:e.form.userPhone,callback:function(t){e.$set(e.form,"userPhone",t)},expression:"form.userPhone"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"城市"}},[s("el-input",{model:{value:e.form.userCity,callback:function(t){e.$set(e.form,"userCity",t)},expression:"form.userCity"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"铭言"}},[s("el-input",{model:{value:e.form.userMotto,callback:function(t){e.$set(e.form,"userMotto",t)},expression:"form.userMotto"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"注册时间"}},[s("el-input",{attrs:{disabled:""},model:{value:e.form.userJoinTime,callback:function(t){e.$set(e.form,"userJoinTime",t)},expression:"form.userJoinTime"}}),e._v(" "),s("span",[e._v("注册时间不能进行更改")])],1),e._v(" "),s("el-form-item",{attrs:{label:"用户状态"}},[s("el-row",{attrs:{type:"flex",justify:"start",gutter:50}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"是否管理员"}},[[s("el-radio-group",{attrs:{disabled:""},model:{value:e.form.userAdmin,callback:function(t){e.$set(e.form,"userAdmin",t)},expression:"form.userAdmin"}},[s("el-radio",{attrs:{label:"true"}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:"false"}},[e._v("否")])],1)]],2)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"账户状态"}},[[s("el-radio-group",{attrs:{disabled:""},model:{value:e.form.userStop,callback:function(t){e.$set(e.form,"userStop",t)},expression:"form.userStop"}},[s("el-radio",{attrs:{label:"true"}},[e._v("封停")]),e._v(" "),s("el-radio",{attrs:{label:"false"}},[e._v("正常")])],1)]],2)],1)],1),e._v(" "),s("el-row",[s("span",[e._v("不能进行更改，如需帮助，请联系管理员")])])],1),e._v(" "),s("el-form-item",{attrs:{label:"简介"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.userDescription,callback:function(t){e.$set(e.form,"userDescription",t)},expression:"form.userDescription"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"标签"}},[s("el-input",{model:{value:e.form.userLabel,callback:function(t){e.$set(e.form,"userLabel",t)},expression:"form.userLabel"}}),e._v(" "),s("span",[e._v("标签请以“/”隔开")])],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("更新")]),e._v(" "),s("el-button",{on:{click:e.rePassword}},[e._v("修改密码")])],1)],1)],1):s("div",{staticClass:"repassword"},[s("h2",[e._v("重置密码")]),e._v(" "),s("el-form",{attrs:{"label-width":"120px"}},[s("el-form-item",{attrs:{label:"输入旧密码"}},[s("el-input",{attrs:{type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"输入新密码"}},[s("el-input",{attrs:{type:"password"},model:{value:e.repassword,callback:function(t){e.repassword=t},expression:"repassword"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.changeUserPassword}},[e._v("修改密码")])],1)],1)],1)]),e._v(" "),s("el-col",{staticClass:"side",attrs:{span:8}},[s("h2",[e._v("其他链接")]),e._v(" "),s("div",[s("span",[e._v(">"),s("router-link",{attrs:{to:"/"}},[e._v("主页")])],1),e._v(" "),s("span",[e._v(">"),s("router-link",{attrs:{to:"/movieList"}},[e._v("电影")])],1),e._v(" "),s("span",[e._v(">"),s("router-link",{attrs:{to:{path:"/userInfo/"+e.user_id}}},[e._v("个人主页")])],1),e._v(" "),s("span",[e._v(">"),s("router-link",{attrs:{to:{path:"/sendEmail"}}},[e._v("发送站内信")])],1)])])],1)],1),e._v(" "),s("div",[s("common-footer")],1)])},staticRenderFns:[]};var Lt={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"junkemail"},[t("h2",[this._v("垃圾邮件")]),this._v(" "),t("div",{staticClass:"main"}),this._v(" "),t("div",{staticClass:"sider"},[t("p",[this._v("暂无垃圾邮件")])])])}]};var Tt=[{path:"/userAccount/:id",name:"userAccount",component:s("VU/8")(Ut,It,!1,function(e){s("9mg6")},"data-v-db942856",null).exports},{path:"/loginPage",name:"loginPage",component:He},{path:"/registerPage",name:"registerPage",component:Oe},{path:"/repassword",name:"repassword",component:qe},{path:"/userInfo/:id",name:"userInfo",component:Ge,children:[{path:"",component:ct},{path:"article",component:Qe},{path:"square",component:at},{path:"diary",component:tt}]},{path:"/sendEmail",name:"sendEmail",component:dt,children:[{path:"",component:gt},{path:"sendtalkbox",component:xt},{path:"followlist",component:yt},{path:"blacklist",component:$t},{path:"junkemail",component:s("VU/8")({name:"junkemail",data:function(){return{}},created:function(){},methods:{}},Lt,!1,function(e){s("ii2n")},"data-v-12f2a8ce",null).exports}]}],Et={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"comments"},[void 0==e.commentList||e.commentList.length<=0?s("div",[e._v("暂无评论")]):s("div",e._l(e.commentList,function(t,a){return s("li",{key:a},[s("div",{staticClass:"user-info"},[s("img",{attrs:{src:t.userImg}}),e._v(" "),s("p",{staticClass:"user"},[s("span",[s("router-link",{attrs:{to:{path:"/userInfo/"+t.user_id}}},[e._v(e._s(t.username))])],1),s("br"),e._v(" "),s("span",[e._v("发布于:"+e._s(e._f("forMatTime")(t.commentTime)))])]),e._v(" "),s("p",{staticClass:"suppose"},[s("i",{staticClass:"el-icon-thumb",on:{click:function(s){return e.commentSuppose(t._id)}}}),e._v("\n\t\t\t\t\t"+e._s(t.commentNumSuppose)+"\n\t\t\t\t")])]),e._v(" "),s("p",[e._v(e._s(t.context))])])}),0)])},staticRenderFns:[]};var At=s("VU/8")({data:function(){return{commentList:[],isSupposeDisable:!1}},props:["movie_id","article_id","flag"],created:function(){this.getData()},watch:{article_id:function(e,t){this.getData()},flag:function(e,t){this.getData()}},methods:{getData:function(){var e=this;function t(t){t.map(function(t){e.axios.post("api/showUserByUserName",{username:t.username}).then(function(s){t.userImg=s.data.data[0].userImg,t.user_id=s.data.data[0]._id,e.commentList.push(t)})})}this.commentList=[],this.movie_id&&this.axios.post("api/movie/commentMovie",{movie_id:this.movie_id}).then(function(e){t(e.data.data)}),this.article_id&&this.axios.post("api/movie/commentArticle",{article_id:this.article_id}).then(function(e){t(e.data.data)})},commentSuppose:function(e){var t=this;this.axios.post("api/movie/commentMovieUpdate",{_id:e}).then(function(e){t.getData()})}}},Et,!1,function(e){s("cuRt")},"data-v-354cbbe6",null).exports,zt={data:function(){return{showstatus:!1,title:"",context:"",commentmark:null,isSupposeDisable:!1}},props:["article_id"],created:function(){},methods:{review:function(){this.showstatus=!0,this.title="写短评"},issue:function(){this.showstatus=!0,this.title="提问题"},share:function(){},sendComment:function(){var e=this;if(""==this.commentmark)return this.mes.promptMessage("评分不能为空");if(""==this.context)return this.mes.promptMessage("评论不能为空");if(localStorage.username){var t={article_id:this.article_id,context:this.context,username:localStorage.username,movieMark:this.commentmark};this.axios.post("api/users/postComment",t).then(function(t){0==t.data.status&&(e.showstatus=!1,e.commentmark=null,e.context="",e.mes.promptMessage("评论成功"),e.$emit("commentSuc"))})}else this.mes.promptMessage("未登陆，2秒后调转登陆界面"),setTimeout(function(t){e.route.push({path:"/loginPage"})},2e3)},support:function(){var e=this;console.log("11"),console.log(this.article_id),console.log("22"),this.axios.post("api/users/support",{article_id:this.article_id}).then(function(t){0==t.data.status?(e.mes.successMessage("点赞成功"),e.$emit("supportSuc"),e.isSupposeDisable=!0):e.mes.promptMessage(t.data.message)})}}},Pt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"downloaddetail"},[s("p",{staticClass:"download"},[s("button",{attrs:{disabled:e.isSupposeDisable},on:{click:e.support}},[e._v("点赞")]),e._v(" "),s("span",[e._v(" 评价:"),s("el-rate",{attrs:{"show-text":""},model:{value:e.commentmark,callback:function(t){e.commentmark=t},expression:"commentmark"}})],1)]),e._v(" "),s("p",{staticClass:"write"},[s("span",[s("i",{staticClass:"el-icon-chat-dot-square"}),e._v(" "),s("span",{on:{click:e.review}},[e._v("写评论")])]),e._v(" "),s("span",[s("i",{staticClass:"el-icon-plus"}),e._v(" "),s("span",{on:{click:e.issue}},[e._v("提问题")])]),e._v(" "),s("span",[s("span",{on:{click:e.share}},[e._v("分享到")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showstatus,expression:"showstatus"}],staticClass:"comment"},[s("h3",[e._v(e._s(e.title))]),e._v(" "),s("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",placeholder:"内容"},model:{value:e.context,callback:function(t){e.context=t},expression:"context"}}),e._v(" "),s("el-button",{on:{click:e.sendComment}},[e._v(" 评论")])],1)])},staticRenderFns:[]};var Bt=s("VU/8")(zt,Pt,!1,function(e){s("Hh1Y")},"data-v-61ae59bc",null).exports,Ft={name:"newDetail",data:function(){return{article_id:"",user:"",flag:1}},created:function(){this.article_id=this.$route.params.id,this.getData()},beforeRouteUpdate:function(e,t,s){this.article_id=e.params.id,this.getData(),s()},methods:{getData:function(){var e=this;this.$store.commit("article/getArticle",{article_id:this.article_id}),this.$store.commit("article/getUserArticle",{articleUserId:this.list.articleUserId}),this.$store.commit("article/setHotArticle"),this.$store.commit("article/setTopic"),this.$store.commit("article/setUserArticleList",{page:1,page_size:5}),this.$store.commit("article/setHotArticleList",{page:1,page_size:5}),this.axios.post("/api/showUser",{user_id:this.list.articleUserId}).then(function(t){e.user=t.data.data[0]})},articleUserChange:function(e){this.$store.commit("article/setUserArticleList",{page:e,page_size:5})},articleHotChange:function(e){this.$store.commit("article/setHotArticleList",{page:e,page_size:5})},listenerComment:function(){this.flag++},listenerSupport:function(){this.list.articleNumSuppose++}},computed:l()({},Object(y.c)("article",{list:function(e){return e.article_detail[0]},article_user_num:function(e){return e.article_user.length},article_list:function(e){return e.article_user_list},article_hot_num:function(e){return e.article_hot.length},article_hot_list:function(e){return e.article_hot_list},article_topic:function(e){return e.article_topic}})),components:{MovieIndexHeader:u,Comment:At,CommonFooter:d,ArticleComment:Bt,NewsList:p}},Rt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",[s("movie-index-header")],1),e._v(" "),s("div",{staticClass:"contentMain"},[s("el-row",{attrs:{gutter:40}},[s("el-col",{staticClass:"article",attrs:{span:18}},[s("div",{staticClass:"content"},[s("div",{staticClass:"article_title"},[s("h2",[e._v("\n\t\t\t\t\t\t\t"+e._s(e.list.articleTitle)+"\n\t\t\t\t\t\t")]),e._v(" "),s("p",[s("span",[s("i",{staticClass:"el-icon-thumb"}),e._v(e._s(e.list.articleNumSuppose)+"\n\t\t\t\t\t\t\t")]),e._v(" "),s("span",[e._v("话题:\n\t\t\t\t\t\t\t\t"),s("router-link",{attrs:{to:{path:"/topic/"+e.list.articleTopic}}},[e._v(e._s(e.list.articleTopic))])],1)])]),e._v(" "),s("div",{staticClass:"article_user"},[s("img",{attrs:{src:e.user.userImg}}),e._v(" "),s("span",[s("router-link",{attrs:{to:{path:"/userInfo/"+e.user._id}}},[e._v(e._s(e.user.username)+"\n\t\t\t\t\t\t\t")]),e._v(" "+e._s(e.user.userMotto)+"\n\t\t\t\t\t\t")],1),e._v(" "),s("span",[e._v("发布于: "+e._s(e._f("forMatTime")(e.list.articleTime)))])]),e._v(" "),s("div",{staticClass:"article_context",domProps:{innerHTML:e._s(e.list.articleContext)}})]),e._v(" "),s("div",{staticClass:"article_post"},[s("article-comment",{attrs:{article_id:e.article_id},on:{commentSuc:e.listenerComment,supportSuc:e.listenerSupport}})],1),e._v(" "),s("div",{staticClass:"article_comment"},[s("h2",[e._v(e._s(e.list.articleTitle)+"短评")]),e._v(" "),s("comment",{attrs:{article_id:e.article_id,flag:e.flag}})],1)]),e._v(" "),s("el-col",{staticClass:"user",attrs:{span:6}},[s("div",{staticClass:"user_info"},[s("img",{attrs:{src:e.user.userImg}}),e._v(" "),s("div",[s("p",[s("router-link",{attrs:{to:{path:"/userInfo/"+e.user._id}}},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(e.user.username)+"\n\t\t\t\t\t\t\t")]),e._v("\n\t\t\t\t\t\t\t"+e._s(e.user.userCity)+"\n\t\t\t\t\t\t")],1),e._v(" "),s("p",[e._v(e._s(e.user.userDescription))])])]),e._v(" "),s("div",{staticClass:"other_article"},[s("div",{staticClass:"pagination"},[s("h2",[e._v("作者的其他文章")]),e._v(" "),s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:Number(e.article_user_num),"page-size":5},on:{"current-change":e.articleUserChange}})],1),e._v(" "),s("news-list",{attrs:{list:e.article_list}})],1),e._v(" "),s("div",{staticClass:"hot_article"},[s("div",{staticClass:"pagination"},[s("h2",[e._v("热门文章")]),e._v(" "),s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:e.article_hot_num,"page-size":5},on:{"current-change":e.articleHotChange}})],1),e._v(" "),s("news-list",{attrs:{list:e.article_hot_list}})],1),e._v(" "),s("div",{staticClass:"hot_topic"},[s("h2",[e._v("热门话题")]),e._v(" "),s("div",e._l(e.article_topic,function(t){return s("span",[s("router-link",{attrs:{to:{path:"/topic/"+t}}},[e._v(e._s(t))])],1)}),0)])])],1)],1),e._v(" "),s("div",[s("common-footer")],1)])},staticRenderFns:[]};var Vt={name:"topic",data:function(){return{}},created:function(){this.topic_name=this.$route.params.id},methods:{},components:{MovieIndexHeader:u,CommonFooter:d}},Ot={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("div",[t("movie-index-header")],1),this._v(" "),t("div",{staticClass:"contentMain"},[t("el-row",{attrs:{gutter:60}},[t("el-col",{attrs:{span:16}},[this._v("\n\t\t\t\t"+this._s(this.topic_name)+"\n\t\t\t")]),this._v(" "),t("el-col",{attrs:{span:8}},[this._v("\n\t\t\t\tcde\n\t\t\t")])],1)],1),this._v(" "),t("div",[t("common-footer")],1)])},staticRenderFns:[]};var Nt=[{path:"/newDetail/:id",name:"newDetail",component:s("VU/8")(Ft,Rt,!1,function(e){s("Kg5V")},"data-v-7e69c15d",null).exports},{path:"/topic/:id",name:"topic",component:s("VU/8")(Vt,Ot,!1,function(e){s("6xlM")},"data-v-787a2c10",null).exports}],jt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("li",[s("img",{attrs:{src:e.commentList.movieImg}}),e._v(" "),s("div",{staticClass:"comment"},[s("p",{staticClass:"movie_name"},[s("router-link",{attrs:{to:{path:"/movieDetail/"+e.commentList.movie_id}}},[e._v(e._s(e.commentList.movieName))])],1),e._v(" "),s("p",{staticClass:"user"},[s("span",[s("router-link",{attrs:{to:{path:"/userInfo/"+e.commentList.user_id}}},[e._v(e._s(e.commentList.username))])],1),e._v(" "),s("span",[e._v("评论于:"+e._s(e._f("forMatTime")(e.commentList.commentTime)))])]),e._v(" "),s("p",{staticClass:"comment_content"},[e._v("\n\t\t\t\t\t"+e._s(e.commentList.context)+"\n\t\t\t\t")]),e._v(" "),s("p",{staticClass:"comment_btn"},[s("span",[s("i",{staticClass:"el-icon-thumb"}),e._v(e._s(e.commentList.commentNumSuppose))]),e._v(" "),e._m(0)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("button",[this._v("点赞")])])}]};var Ht=s("VU/8")({data:function(){return{}},props:["commentList"],created:function(){},methods:{}},jt,!1,function(e){s("zV/V")},"data-v-b798955c",null).exports,Wt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._l(e.list,function(t,a){return s("li",{key:a,staticClass:"movies"},[s("div",{staticClass:"movieslist"},[s("p",{staticClass:"left"},[e._v("\n\t\t\t\t"+e._s(a+1)+":"),s("router-link",{attrs:{to:{path:"/movieDetail/"+t._id}}},[e._v(e._s(t.movieName)+"\n\t\t\t")])],1),e._v(" "),s("p",{staticClass:"right"},[e._v("下载量:"),s("span",[e._v(e._s(t.movieNumDownload))])])])])}),0)},staticRenderFns:[]};var Jt=s("VU/8")({name:"moviesList",data:function(){return{}},props:["list"],created:function(){},methods:{}},Wt,!1,function(e){s("bgpQ")},"data-v-a90bf846",null).exports,qt={name:"movielist",data:function(){return{commentList:[],list:[],moviedownload:[],activity:""}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.$store.dispatch("movie/getData"),this.axios.post("api/movie/commentAll").then(function(t){t.data.data.forEach(function(t){t.movie_id&&e.commentList.push(t)}),e.commentList.sort(function(e,t){return t.commentNumSuppose-e.commentNumSuppose}),e.commentList.forEach(function(t){e.axios.post("api/showUserByUserName",{username:t.username}).then(function(e){t.userImg=e.data.data[0].userImg,t.user_id=e.data.data[0]._id})}),e.commentList.forEach(function(t){e.axios.post("api/movie/movieDetail",{movie_id:t.movie_id}).then(function(e){t.movieName=e.data.data.movieName,t.movieImg=e.data.data.movieImg})})}),this.axios.get("api/showActivity").then(function(t){e.activity=t.data.data[0]})},showMessage:function(){this.mes.errorMessage("暂未开通这个链接")},getCommentList:function(e){var t=Number(e);this.list=this.commentList.slice(5*(t-1),5*t)},onChange:function(e){this.$store.commit("movie/getOnMovieList",{page:e,page_size:5})}},computed:l()({},Object(y.c)("movie",{getOnMovieList:function(e){return e.on_movie_list},getOnPage:function(e){return e.on_movie.length}}),Object(y.b)("movie",["getHotMovieList","getDownloadMovieList"])),components:{MovieIndexHeader:u,CommonFooter:d,MovieList:h,MovieComment:Ht,MoviesList:Jt}},Yt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",[s("movie-index-header")],1),e._v(" "),s("div",{staticClass:"contentMain"},[s("el-row",{attrs:{gutter:60}},[s("el-col",{staticClass:"main",attrs:{span:14}},[s("div",{staticClass:"show"},[s("div",{staticClass:"pagination"},[s("h2",[e._v("正在上映")]),e._v(" "),s("el-pagination",{attrs:{small:"",layout:"prev, pager, next","page-size":5,total:Number(e.getOnPage)},on:{"current-change":e.onChange}})],1),e._v(" "),s("div",{staticClass:"onshow"},e._l(e.getOnMovieList,function(e,t){return s("div",{key:t},[s("movie-list",{attrs:{list:e}})],1)}),0)]),e._v(" "),s("div",{staticClass:"show"},[s("div",{staticClass:"pagination"},[s("h2",[e._v("最近热门的电影")])]),e._v(" "),s("div",{staticClass:"onshow"},e._l(e.getHotMovieList,function(e,t){return s("div",{key:t},[s("movie-list",{attrs:{list:e}})],1)}),0)]),e._v(" "),s("div",{staticClass:"show"},[s("div",{staticClass:"pagination"},[s("h2",[e._v("最受欢迎的影评")]),e._v(" "),s("el-pagination",{attrs:{small:"",layout:"prev, pager, next","page-size":5,total:e.commentList.length},on:{"current-change":e.getCommentList}})],1),e._v(" "),s("div",{staticClass:"comment"},e._l(e.list,function(e,t){return s("div",{key:t},[s("movie-comment",{attrs:{commentList:e}})],1)}),0)])]),e._v(" "),s("el-col",{staticClass:"sider",attrs:{span:10}},[s("div",{staticClass:"activity"},[s("h2",[e._v("电影活动")]),e._v(" "),s("router-link",{attrs:{to:{}},nativeOn:{click:function(t){return e.showMessage(t)}}},[e._v("\n\t\t\t\t\t\t"+e._s(e.activity.title)+"\n\t\t\t\t\t")]),e._v(" "),s("p",[e._v("活动将于"+e._s(e._f("forMatTime")(e.activity.startTime))+"开展，详情请戳上方链接哦")])],1),e._v(" "),s("div",[s("h2",[e._v("电影下载周榜")]),e._v(" "),s("movies-list",{attrs:{list:e.getDownloadMovieList}})],1)])],1)],1),e._v(" "),s("div",[s("common-footer")],1)])},staticRenderFns:[]};var Kt=s("VU/8")(qt,Yt,!1,function(e){s("Mmi6")},"data-v-177639c9",null).exports,Gt={data:function(){return{showstatus:!1,title:"",context:"",commentmark:"",username:"",isSupposeDisable:!1,isWantseeDisable:!1,isDownloadDisable:!1}},props:["movie_id"],created:function(){},methods:{review:function(){this.showstatus=!0,this.title="写短评"},film:function(){this.showstatus=!0,this.title="写影评"},issue:function(){this.showstatus=!0,this.title="提问题"},share:function(){},sendComment:function(){var e=this;if(""==this.commentmark)return this.mes.errorMessage("评分不能为空");if(""==this.context)return this.mes.errorMessage("评论不能为空");if(!localStorage.username)return setTimeout(function(){return e.$route.push({path:"/loginPage"})},2e3),this.mes.promptMessage("请先进行登陆，2秒后跳转登陆界面");var t={movie_id:this.movie_id,context:this.context,movieMark:this.commentmark,username:localStorage.username};this.axios.post("api/users/postComment",t).then(function(t){0==t.data.status&&(e.commentmark="",e.showstatus=!1,e.context="",e.mes.successMessage("评论成功"),e.$emit("commentSuc"))})},support:function(){var e=this;this.axios.post("api/users/support",{movie_id:this.movie_id}).then(function(t){0==t.data.status&&(e.mes.successMessage("点赞成功"),e.$emit("supportSuc"),e.isSupposeDisable=!0)})},wantsee:function(){var e=this;this.axios.post("api/users/wantsee",{movie_id:this.movie_id}).then(function(t){0==t.data.status&&(e.mes.successMessage("操作成功"),e.$emit("wantseeSuc"),e.isWantseeDisable=!0)})},movieDownload:function(){var e=this;this.axios.post("api/users/download",{movie_id:this.movie_id}).then(function(t){0==t.data.status&&(e.mes.successMessage("下载成功，只会增加下载条数"),e.$emit("downloadSuc"),e.isDownloadDisable=!0,setTimeout(function(){window.location=res.data.data.movieDownload},2e4))})}}},Xt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"downloaddetail"},[s("p",{staticClass:"download"},[s("button",{attrs:{disabled:e.isDownloadDisable},on:{click:e.movieDownload}},[e._v("下载")]),e._v(" "),s("button",{attrs:{disabled:e.isSupposeDisable},on:{click:e.support}},[e._v("点赞")]),e._v(" "),s("button",{attrs:{disabled:e.isWantseeDisable},on:{click:e.wantsee}},[e._v("想看")]),e._v(" "),s("span",[e._v(" 评价:"),s("el-rate",{attrs:{"show-text":""},model:{value:e.commentmark,callback:function(t){e.commentmark=t},expression:"commentmark"}})],1)]),e._v(" "),s("p",{staticClass:"write"},[s("span",[s("i",{staticClass:"el-icon-chat-dot-square"}),e._v(" "),s("span",{on:{click:e.review}},[e._v("写短评")])]),e._v(" "),s("span",[s("i",{staticClass:"el-icon-edit"}),e._v(" "),s("span",{on:{click:e.film}},[e._v("写影评")])]),e._v(" "),s("span",[s("i",{staticClass:"el-icon-plus"}),e._v(" "),s("span",{on:{click:e.issue}},[e._v("提问题")])]),e._v(" "),s("span",[s("span",{on:{click:e.share}},[e._v("分享到")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showstatus,expression:"showstatus"}],staticClass:"comment"},[s("h3",[e._v(e._s(e.title))]),e._v(" "),s("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",placeholder:"内容"},model:{value:e.context,callback:function(t){e.context=t},expression:"context"}}),e._v(" "),s("el-button",{on:{click:e.sendComment}},[e._v(" 评论")])],1)])},staticRenderFns:[]};var Zt={name:"moviedetail",data:function(){return{list:"",movie_id:"",flag:1}},created:function(){this.movie_id=this.$route.params.id,this.getData()},methods:{getData:function(){var e=this;this.axios.post("api/movieDetail",{movie_id:this.movie_id}).then(function(t){e.list=t.data.data})},listenerComment:function(){this.flag++},btnBuy:function(){this.$router.push({path:"/movieBuy"})}},components:{MovieIndexHeader:u,Comment:At,CommonFooter:d,DownloadDetail:s("VU/8")(Gt,Xt,!1,function(e){s("XUyS")},"data-v-11db2051",null).exports}},Qt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",[s("movie-index-header")],1),e._v(" "),s("div",{staticClass:"contentMain"},[s("el-row",{attrs:{gutter:60}},[s("el-col",{attrs:{span:16}},[s("div",{staticClass:"content"},[s("div",{staticClass:"movie_title"},[s("h2",[e._v(e._s(e.list.movieName))])]),e._v(" "),s("div",{staticClass:"detail"},[s("div",{staticClass:"movie_img"},[s("img",{attrs:{src:e.list.movieImg}})]),e._v(" "),s("div",{staticClass:"movie_detail"},[s("p",[e._v("导演: \n\t\t\t\t\t\t\t\t"),s("span",[s("router-link",{attrs:{to:""}},[e._v(e._s(e.list.movieDirector))])],1)]),e._v(" "),s("p",[e._v("编剧: \n\t\t\t\t\t\t\t\t"),s("span",[s("router-link",{attrs:{to:""}},[e._v(e._s(e.list.movieWrite))])],1)]),e._v(" "),s("p",[e._v("演员: \n\t\t\t\t\t\t\t\t"),s("span",[s("router-link",{attrs:{to:""}},[e._v(e._s(e.list.movieActor))])],1)]),e._v(" "),s("p",[e._v("制片国家/地区: \n\t\t\t\t\t\t\t\t"),s("span",[e._v(e._s(e.list.movieCountry))])]),e._v(" "),s("p",[e._v("上映日期: \n\t\t\t\t\t\t\t\t"),s("span",[e._v(e._s(e._f("forMatDate")(e.list.movieShowTime)))])]),e._v(" "),s("p",[e._v("片长时间: \n\t\t\t\t\t\t\t\t"),s("span",[e._v(e._s(e.list.movieDuration))])])]),e._v(" "),s("div",{staticClass:"comment_detail"},[s("p",[e._v("\n\t\t\t\t\t\t\t\t豆瓣评分:\n\t\t\t\t\t\t\t\t"),s("span",[s("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900"},model:{value:e.list.movieMark,callback:function(t){e.$set(e.list,"movieMark",t)},expression:"list.movieMark"}})],1)]),e._v(" "),s("p",[e._v("\n\t\t\t\t\t\t\t\t想看:"),s("span",[e._v(e._s(e.list.movieNumWantSee))])]),e._v(" "),s("p",[e._v("\n\t\t\t\t\t\t\t\t下载:"),s("span",[e._v(e._s(e.list.movieNumDownload))])]),e._v(" "),s("p",[e._v("\n\t\t\t\t\t\t\t\t支持:"),s("span",[e._v(e._s(e.list.movieNumSuppose))])])])]),e._v(" "),s("div",{staticClass:"download_detail"},[s("download-detail",{attrs:{movie_id:e.movie_id},on:{commentSuc:e.listenerComment,supportSuc:e.getData,wantseeSuc:e.getData,downloadSuc:e.getData}})],1),e._v(" "),s("div",{staticClass:"story_detail"},[s("h3",[e._v(e._s(e.list.movieName)+"剧情简介......")]),e._v(" "),s("p",[e._v(e._s(e.list.movieDetail))])]),e._v(" "),s("div",{staticClass:"comment_detail"},[s("h3",[e._v(e._s(e.list.movieName)+"的短评......")]),e._v(" "),s("comment",{attrs:{movie_id:e.movie_id,flag:e.flag}})],1)])]),e._v(" "),s("el-col",{attrs:{span:8}},[s("div",{staticClass:"side"},[s("div",{staticClass:"movie_buy"},[s("button",{on:{click:e.btnBuy}},[e._v("购票")])])])])],1)],1),e._v(" "),s("div",[s("common-footer")],1)])},staticRenderFns:[]};var es={name:"movieBuy",data:function(){return{}},created:function(){},methods:{},components:{MovieIndexHeader:u,CommonFooter:d}},ts={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("div",[t("movie-index-header")],1),this._v(" "),t("div",{staticClass:"contentMain"},[t("el-row",{attrs:{gutter:60}},[t("el-col",{attrs:{span:16}},[this._v("\n\t\t\t\t暂未开通此项功能\n\t\t\t")]),this._v(" "),t("el-col",{attrs:{span:8}},[this._v("\n\t\t\t\tcde\n\t\t\t")])],1)],1),this._v(" "),t("div",[t("common-footer")],1)])},staticRenderFns:[]};var ss=[{path:"/movieList",name:"movieList",component:Kt},{path:"/movieDetail/:id",name:"movieDetail",component:s("VU/8")(Zt,Qt,!1,function(e){s("jeNS")},"data-v-67153b96",null).exports},{path:"/movieBuy",name:"movieBuy",component:s("VU/8")(es,ts,!1,function(e){s("+cFj")},"data-v-7f17f55e",null).exports}];n.default.use(r.a);t.a=new r.a({routes:[].concat(i()(Fe),i()(Tt),i()(Nt),i()(ss),[{path:"/",name:"index",component:D}])})},YcDP:function(e,t){},Yjyw:function(e,t){},aemg:function(e,t){},aloF:function(e,t){},bgpQ:function(e,t){},c9ag:function(e,t){},cs8D:function(e,t){},cuRt:function(e,t){},dHp5:function(e,t){},eSeJ:function(e,t){},f0KU:function(e,t){},fdAK:function(e,t){},fdud:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.d(t,"forMatTime",function(){return a}),s.d(t,"forMatDate",function(){return i});var a=function(e){var t=new Date(parseInt(e));return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+(t.getDate()<10?"0"+t.getDate()+" ":t.getDate()+" ")+(t.getHours()<10?"0"+t.getHours()+":":t.getHours()+":")+(t.getMinutes()<10?"0"+t.getMinutes()+":":t.getMinutes()+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},i=function(e){var t=new Date(parseInt(e));return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+(t.getDate()<10?"0"+t.getDate()+" ":t.getDate()+" ")}},gOxp:function(e,t){},hNev:function(e,t,s){"use strict";var a=s("AFc0"),i={name:"elmunuitemgroup",props:{menu:{type:Object}},components:{ElMenuItemEx:a.a},beforeCreate:function(){this.$options.components.ElSubmenuEx=s("pPz8").default},data:function(){return{}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return"group"==e.menu.type?s("el-menu-item-group",[s("template",{slot:"title"},[s("i",{class:e.menu.icon}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.menu.lable))])]),e._v(" "),e._l(e.menu.childs,function(t){return null!=e.menu.childs?[s("el-menu-item-ex",{attrs:{menu:t}}),e._v(" "),s("el-submenu-ex",{attrs:{menu:t}})]:e._e()})],2):e._e()},staticRenderFns:[]};var r=s("VU/8")(i,n,!1,function(e){s("0zUu")},"data-v-23c515fa",null);t.a=r.exports},ii2n:function(e,t){},iwA8:function(e,t){},jeNS:function(e,t){},l81T:function(e,t){},"lH/p":function(e,t){},lcK2:function(e,t){},lhke:function(e,t){},muti:function(e,t){},nkvL:function(e,t){},pPz8:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("hNev"),i=s("AFc0"),n={name:"elsubmenu",props:{menu:{type:Object}},beforeCreate:function(){this.$options.components.ElSubmenuEx=s("pPz8").default},components:{ElMenuItemGroupEx:a.a,ElMenuItemEx:i.a},data:function(){return{}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return"submenu"==e.menu.type?s("el-submenu",{attrs:{index:e.menu.index,route:e.menu.route}},[null!=e.menu.lable?s("template",{slot:"title"},[s("i",{class:e.menu.icon}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.menu.lable))])]):e._e(),e._v(" "),e._l(e.menu.childs,function(t){return null!=e.menu.childs?[s("el-menu-item-group-ex",{attrs:{menu:t}}),e._v(" "),s("el-menu-item-ex",{attrs:{menu:t}}),e._v(" "),s("el-submenu-ex",{attrs:{menu:t}})]:e._e()})],2):e._e()},staticRenderFns:[]};var o=s("VU/8")(n,r,!1,function(e){s("t84o")},"data-v-0a470420",null);t.default=o.exports},qDol:function(e,t){},qS3c:function(e,t){},qlS9:function(e,t){},"rbq/":function(e,t){},sz3g:function(e,t){},t0uw:function(e,t){},t84o:function(e,t){},tthb:function(e,t){},tvR6:function(e,t){},uO82:function(e,t){},vFM9:function(e,t){},vobF:function(e,t){},wVAH:function(e,t){},xCZg:function(e,t){},xV6C:function(e,t){},xvVk:function(e,t){},xzLO:function(e,t){},yeBs:function(e,t){},z6ri:function(e,t){},"zV/V":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.a7f9efdb1eb3ebdd5d9e.js.map